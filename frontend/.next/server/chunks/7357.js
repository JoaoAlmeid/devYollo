"use strict";exports.id=7357,exports.ids=[7357],exports.modules={14310:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(95027),i=a(87462),s=a(43349),o=a(90953),r=(0,n.styleFunctionSx)((0,n.compose)(n.borders,n.display,n.flexbox,n.grid,n.positions,n.palette,n.shadows,n.sizing,n.spacing,n.typography));let l=(function(e){var t=(0,s.styled)("div");return function(e,a){return t(e,(0,i.Z)({defaultTheme:o.Z},a))}})(0)(r,{name:"MuiBox"})},66856:(e,t,a)=>{a.d(t,{Z:()=>d});var n=a(87462),i=a(91),s=a(16689);a(580);var o=a(68103),r=a.n(o),l=a(52543),c=s.forwardRef(function(e,t){var a=e.disableSpacing,o=e.classes,l=e.className,c=(0,i.Z)(e,["disableSpacing","classes","className"]);return s.createElement("div",(0,n.Z)({className:r()(o.root,l,!(void 0!==a&&a)&&o.spacing),ref:t},c))});let d=(0,l.Z)({root:{display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},spacing:{"& > :not(:first-child)":{marginLeft:8}}},{name:"MuiDialogActions"})(c)},89230:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(20997),i=a(43349);a(16689);let s=(0,i.makeStyles)(e=>({tag:{padding:"1px 5px",borderRadius:"3px",fontSize:"0.8em",fontWeight:"bold",color:"#FFF",marginRight:"5px",whiteSpace:"nowrap"}})),o=({tag:e})=>{let t=s();return n.jsx("div",{className:t.tag,style:{backgroundColor:e.color,marginTop:"2px"},children:e.name.toUpperCase()})}},76492:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{E:()=>x});var i=a(20997),s=a(14310),o=a(16204),r=a(39803),l=a(88129),c=a.n(l),d=a(16689),p=a(151),u=a(38561),g=e([p]);function x({onFiltered:e}){let[t,a]=(0,d.useState)([]),[n,l]=(0,d.useState)([]);(0,d.useEffect)(()=>{(async function(){await g()})()},[]);let g=async()=>{try{let{data:e}=await u.Z.get("/tags/list");a(e)}catch(e){(0,p.Z)(e)}},x=async t=>{l(t),e(t)};return i.jsx(s.Z,{style:{padding:10},children:i.jsx(c(),{multiple:!0,size:"small",options:t,value:n,onChange:(e,t,a)=>x(t),getOptionLabel:e=>e.name,renderTags:(e,t)=>e.map((e,a)=>i.jsx(o.Z,{variant:"outlined",style:{backgroundColor:e.color||"#eee",textShadow:"1px 1px 1px #000",color:"white"},label:e.name,...t({index:a}),size:"small"})),renderInput:e=>i.jsx(r.Z,{...e,variant:"outlined",placeholder:"Filtro por Tags"})})})}p=(g.then?(await g)():g)[0],n()}catch(e){n(e)}})},74312:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{Z:()=>J});var i=a(20997),s=a(16689),o=a.n(s),r=a(14661),l=a(81743),c=a(78420),d=a(56794),p=a(68103),u=a.n(p),g=a(48308),x=a(55223),m=a(26256),h=a.n(m),f=a(45168),y=a.n(f),b=a(30774),k=a.n(b),j=a(57051),T=a.n(j),C=a(54104),S=a.n(C),v=a(2098),I=a.n(v),w=a(92217),Z=a.n(w),E=a(86489),R=a.n(E),N=a(40124),L=a.n(N),A=a(92921),D=a(38561),M=a(79213),W=a(40087),F=a(25108),q=a(58582),z=a(5557),B=a(151),U=a(46555);a(76164),a(79723);var O=a(77184),_=a.n(O),P=a(2458),$=a.n(P),H=a(61789);a(57579),a(73995);var K=a(89230),Q=e([W,q,B,U,H]);[W,q,B,U,H]=Q.then?(await Q)():Q;let G=(0,g.makeStyles)(e=>({ticket:{position:"relative"},pendingTicket:{cursor:"unset"},queueTag:{background:"#FCFCFC",color:"#000",marginRight:1,padding:1,fontWeight:"bold",paddingLeft:5,paddingRight:5,borderRadius:3,fontSize:"0.8em",whiteSpace:"nowrap"},noTicketsDiv:{display:"flex",height:"100px",margin:40,flexDirection:"column",alignItems:"center",justifyContent:"center"},newMessagesCount:{position:"absolute",alignSelf:"center",marginRight:8,marginLeft:"auto",top:"10px",left:"20px",borderRadius:0},noTicketsText:{textAlign:"center",color:"rgb(104, 121, 146)",fontSize:"14px",lineHeight:"1.4"},connectionTag:{background:"green",color:"#FFF",marginRight:1,padding:1,fontWeight:"bold",paddingLeft:5,paddingRight:5,borderRadius:3,fontSize:"0.8em",whiteSpace:"nowrap"},noTicketsTitle:{textAlign:"center",fontSize:"16px",fontWeight:"600",margin:"0px"},contactNameWrapper:{display:"flex",justifyContent:"space-between",marginLeft:"5px"},lastMessageTime:{justifySelf:"flex-end",textAlign:"right",position:"relative",top:-21},closedBadge:{alignSelf:"center",justifySelf:"flex-end",marginRight:32,marginLeft:"auto"},contactLastMessage:{paddingRight:"0%",marginLeft:"5px"},badgeStyle:{color:"white",backgroundColor:x.green[500]},acceptButton:{position:"absolute",right:"108px"},acceptButton:{position:"absolute",left:"50%"},ticketQueueColor:{flex:"none",width:"8px",height:"100%",position:"absolute",top:"0%",left:"0%"},ticketInfo:{position:"relative",top:-13},secondaryContentSecond:{display:"flex",alignItems:"flex-start",flexWrap:"wrap",flexDirection:"row",alignContent:"flex-start"},ticketInfo1:{position:"relative",top:13,right:0},Radiusdot:{"& .MuiBadge-badge":{borderRadius:2,position:"inherit",height:16,margin:2,padding:3},"& .MuiBadge-anchorOriginTopRightRectangle":{transform:"scale(1) translate(0%, -40%)"}}})),J=({ticket:e})=>{let t=G(),a=(0,r.useNavigate)(),[n,p]=(0,s.useState)(!1),[g,m]=(0,s.useState)(null),[f,b]=(0,s.useState)(null),[j,C]=(0,s.useState)(null),[v,w]=(0,s.useState)([]),[E,N]=(0,s.useState)(null),[O,P]=(0,s.useState)(!1),{ticketId:Q}=(0,r.useParams)(),J=(0,s.useRef)(!0),{setCurrentTicket:V}=(0,s.useContext)(z.o),{user:Y}=(0,s.useContext)(q.V),{profile:X}=Y;(0,s.useEffect)(()=>(e.userId&&e.user&&m(e.user?.name?.toUpperCase()),b(e.queue?.name?.toUpperCase()),C(e.queue?.color),e.whatsappId&&e.whatsapp&&N(e.whatsapp.name?.toUpperCase()),w(e?.tags),()=>{J.current=!1}),[]);let ee=async t=>{w(e?.tags),p(!0);try{await D.Z.put(`/tickets/${t}`,{status:"closed",userId:Y?.id,queueId:e?.queue?.id})}catch(e){p(!1),(0,B.Z)(e)}J.current&&p(!1),a.push("/tickets/")},et=async t=>{p(!0);try{await D.Z.put(`/tickets/${t}`,{status:"open",userId:Y?.id,queueId:e?.queue?.id})}catch(e){p(!1),(0,B.Z)(e)}J.current&&p(!1),a.push(`/tickets/${e.uuid}`)},ea=async t=>{p(!0);try{let a;await D.Z.put(`/tickets/${t}`,{status:"open",userId:Y?.id});try{let{data:e}=await D.Z.get("/settings/");a=e.filter(e=>"sendGreetingAccepted"===e.key)}catch(e){(0,B.Z)(e)}"enabled"!==a[0].value||e.isGroup||en(e.id)}catch(e){p(!1),(0,B.Z)(e)}J.current&&p(!1),a.push(`/tickets/${e.uuid}`)},en=async e=>{let t=`{{ms}} *{{name}}*, meu nome \xe9 *${Y?.name}* e agora vou prosseguir com seu\xa0atendimento!`,a={read:1,fromMe:!0,mediaUrl:"",body:`*Mensagem Autom\xe1tica:*
${t.trim()}`};try{await D.Z.post(`/messages/${e}`,a)}catch(e){(0,B.Z)(e)}},ei=e=>{let t=(0,U.v4)(),{id:a,uuid:n}=e;V({id:a,uuid:n,code:t})};return(0,i.jsxs)(o().Fragment,{children:[i.jsx(H.Z,{open:O,handleClose:()=>P(!1),ticketId:e.id}),(0,i.jsxs)(h(),{dense:!0,button:!0,onClick:t=>{"pending"!==e.status&&ei(e)},selected:Q&&+Q===e.id,className:u()(t.ticket,{[t.pendingTicket]:"pending"===e.status}),children:[i.jsx(F.ZP,{arrow:!0,placement:"right",title:e.queue?.name?.toUpperCase()||"SEM FILA",children:i.jsx("span",{style:{backgroundColor:e.queue?.color||"#7C7C7C"},className:t.ticketQueueColor})}),i.jsx(k(),{children:"pending"!==e.status?i.jsx(I(),{style:{marginTop:"-20px",marginLeft:"-3px",width:"55px",height:"55px",borderRadius:"10%"},src:e?.contact?.profilePicUrl}):i.jsx(I(),{style:{marginTop:"-30px",marginLeft:"0px",width:"50px",height:"50px",borderRadius:"10%"},src:e?.contact?.profilePicUrl})}),i.jsx(y(),{disableTypography:!0,primary:(0,i.jsxs)("span",{className:t.contactNameWrapper,children:[(0,i.jsxs)(S(),{noWrap:!0,component:"span",variant:"body2",color:"textPrimary",children:[e.contact.name,"admin"===X&&i.jsx(F.ZP,{title:"Espiar Conversa",children:i.jsx($(),{onClick:()=>P(!0),fontSize:"small",style:{color:x.blue[700],cursor:"pointer",marginLeft:10,verticalAlign:"middle"}})})]}),i.jsx(T(),{children:i.jsx(L(),{className:t.ticketInfo1,children:i.jsx(i.Fragment,{children:e.chatbot&&i.jsx(F.ZP,{title:"Chatbot",children:i.jsx(_(),{fontSize:"small",style:{color:x.grey[700],marginRight:5}})})})})})]}),secondary:(0,i.jsxs)("span",{className:t.contactNameWrapper,children:[(0,i.jsxs)(S(),{className:t.contactLastMessage,noWrap:!0,component:"span",variant:"body2",color:"textSecondary",children:[" ",e.lastMessage.includes("data:image/png;base64")?i.jsx(W.Z,{children:" Localiza\xe7\xe3o"}):i.jsx(W.Z,{children:e.lastMessage}),(0,i.jsxs)("span",{className:t.secondaryContentSecond,children:[e?.whatsapp?.name?i.jsx(R(),{className:t.connectionTag,children:e?.whatsapp?.name?.toUpperCase()}):i.jsx("br",{}),g?i.jsx(R(),{style:{backgroundColor:"#000000"},className:t.connectionTag,children:g}):i.jsx("br",{}),i.jsx(R(),{style:{backgroundColor:e.queue?.color||"#7c7c7c"},className:t.connectionTag,children:e.queue?.name?.toUpperCase()||"SEM FILA"})]}),i.jsx("span",{style:{paddingTop:"2px"},className:t.secondaryContentSecond,children:v?.map(t=>i.jsx(K.Z,{tag:t},`ticket-contact-tag-${e.id}-${t.id}`))})]}),i.jsx(R(),{className:t.newMessagesCount,badgeContent:e.unreadMessages,classes:{badge:t.badgeStyle}})]})}),i.jsx(T(),{children:e.lastMessage&&(0,i.jsxs)(i.Fragment,{children:[i.jsx(S(),{className:t.lastMessageTime,component:"span",variant:"body2",color:"textSecondary",children:(0,l.Z)((0,c.Z)(e.updatedAt),new Date)?i.jsx(i.Fragment,{children:(0,d.Z)((0,c.Z)(e.updatedAt),"HH:mm")}):i.jsx(i.Fragment,{children:(0,d.Z)((0,c.Z)(e.updatedAt),"dd/MM/yyyy")})}),i.jsx("br",{})]})}),(0,i.jsxs)("span",{className:t.secondaryContentSecond,children:["pending"===e.status&&i.jsx(M.Z,{style:{backgroundColor:"green",color:"white",padding:"0px",bottom:"17px",borderRadius:"0px",left:"8px",fontSize:"0.6rem"},variant:"contained",className:t.acceptButton,size:"small",loading:n,onClick:t=>ea(e.id),children:A.a.t("ticketsList.buttons.accept")}),"closed"!==e.status&&i.jsx(M.Z,{style:{backgroundColor:"red",color:"white",padding:"0px",bottom:"0px",borderRadius:"0px",left:"8px",fontSize:"0.6rem"},variant:"contained",className:t.acceptButton,size:"small",loading:n,onClick:t=>ee(e.id),children:A.a.t("ticketsList.buttons.closed")}),"closed"===e.status&&i.jsx(M.Z,{style:{backgroundColor:"red",color:"white",padding:"0px",bottom:"0px",borderRadius:"0px",left:"8px",fontSize:"0.6rem"},variant:"contained",className:t.acceptButton,size:"small",loading:n,onClick:t=>et(e.id),children:A.a.t("ticketsList.buttons.reopen")})]})]}),i.jsx(Z(),{variant:"inset",component:"li"})]},e.id)};n()}catch(e){n(e)}})},61789:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{Z:()=>T});var i=a(20997),s=a(16689),o=a(3590),r=a(38561),l=a(151),c=a(41120),d=a(14310),p=a(93579),u=a(66856),g=a(282),x=a(14661),m=a(58582),h=a(59349),f=a(41447),y=a(80314),b=a(7165),k=a(7405),j=e([o,l,m,h,k]);[o,l,m,h,k]=j.then?(await j)():j;let C=(0,c.Z)(e=>({root:{display:"flex",height:"100%",position:"relative",overflow:"hidden"},mainWrapper:{flex:1,height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"0",marginRight:-320,transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},mainWrapperShift:{borderTopRightRadius:0,borderBottomRightRadius:0,transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0}}));function T({open:e,handleClose:t,ticketId:a}){let n=(0,x.useNavigate)(),c=C(),{user:j}=(0,s.useContext)(m.V),[,T]=(0,s.useState)(!1),[S,v]=(0,s.useState)(!0),[I,w]=(0,s.useState)({}),[Z,E]=(0,s.useState)({});(0,s.useEffect)(()=>{let t=null;return e&&(v(!0),t=setTimeout(()=>{(async()=>{try{let{data:e}=await r.Z.get("/tickets/"+a),{queueId:t}=e,{queues:i,profile:s}=j,l=i.find(e=>e.id===t);if(void 0===l&&"admin"!==s){o.toast.error("Acesso n\xe3o permitido"),n.push("/tickets");return}w(e.contact),E(e),v(!1)}catch(e){v(!1),(0,l.Z)(e)}})()},500)),()=>{null!==t&&clearTimeout(t)}},[a,j,n,e]),(0,s.useEffect)(()=>{let t=localStorage.getItem("companyId"),a=null;return e&&((a=(0,k.C)({companyId:t})).on("connect",()=>a.emit("joinChatBox",`${Z.id}`)),a.on(`company-${t}-ticket`,e=>{"update"===e.action&&E(e.ticket),"delete"===e.action&&(o.toast.success("Ticket deleted sucessfully."),n.push("/tickets"))}),a.on(`company-${t}-contact`,e=>{"update"===e.action&&w(t=>t.id===e.contact?.id?{...t,...e.contact}:t)})),()=>{null!==a&&a.disconnect()}},[a,Z,n,e]);let R=()=>{T(!0)};return(0,i.jsxs)(p.Z,{maxWidth:"md",onClose:t,open:e,children:[i.jsx(y.Z,{loading:S,children:(()=>{if(void 0!==Z.user)return i.jsx(b.Z,{contact:I,ticket:Z,onClick:R})})()}),i.jsx(f.J,{children:i.jsx(d.Z,{className:c.root,children:i.jsx(h.Z,{ticket:Z,ticketId:Z.id,isGroup:Z.isGroup})})}),i.jsx(u.Z,{children:i.jsx(g.Z,{onClick:t,color:"primary",children:"Fechar"})})]})}n()}catch(e){n(e)}})},41997:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{Z:()=>k});var i=a(20997),s=a(16689),o=a(48308),r=a(65031),l=a.n(r),c=a(40640),d=a.n(c),p=a(74312),u=a(58891),g=a(44349),x=a(92921),m=a(58582),h=a(7405),f=e([p,g,m,h]);[p,g,m,h]=f.then?(await f)():f;let y=(0,o.makeStyles)(e=>({ticketsListWrapper:{position:"relative",display:"flex",height:"100%",flexDirection:"column",overflow:"hidden",borderTopRightRadius:0,borderBottomRightRadius:0},ticketsList:{flex:1,maxHeight:"100%",overflowY:"scroll",...e.scrollbarStyles,borderTop:"2px solid rgba(0, 0, 0, 0.12)"},ticketsListHeader:{color:"rgb(67, 83, 105)",zIndex:2,backgroundColor:"white",borderBottom:"1px solid rgba(0, 0, 0, 0.12)",display:"flex",alignItems:"center",justifyContent:"space-between"},ticketsCount:{fontWeight:"normal",color:"rgb(104, 121, 146)",marginLeft:"8px",fontSize:"14px"},noTicketsText:{textAlign:"center",color:"rgb(104, 121, 146)",fontSize:"14px",lineHeight:"1.4"},noTicketsTitle:{textAlign:"center",fontSize:"16px",fontWeight:"600",margin:"0px"},noTicketsDiv:{display:"flex",height:"100px",margin:40,flexDirection:"column",alignItems:"center",justifyContent:"center"}})),b=(e,t)=>{if("LOAD_TICKETS"===t.type)return t.payload.forEach(t=>{let a=e.findIndex(e=>e.id===t.id);-1!==a?(e[a]=t,t.unreadMessages>0&&e.unshift(e.splice(a,1)[0])):e.push(t)}),[...e];if("RESET_UNREAD"===t.type){let a=t.payload,n=e.findIndex(e=>e.id===a);return -1!==n&&(e[n].unreadMessages=0),[...e]}if("UPDATE_TICKET"===t.type){let a=t.payload,n=e.findIndex(e=>e.id===a.id);return -1!==n?e[n]=a:e.unshift(a),[...e]}if("UPDATE_TICKET_UNREAD_MESSAGES"===t.type){let a=t.payload,n=e.findIndex(e=>e.id===a.id);return -1!==n?(e[n]=a,e.unshift(e.splice(n,1)[0])):e.unshift(a),[...e]}if("UPDATE_TICKET_CONTACT"===t.type){let a=t.payload,n=e.findIndex(e=>e.contactId===a.id);return -1!==n&&(e[n].contact=a),[...e]}if("DELETE_TICKET"===t.type){let a=t.payload,n=e.findIndex(e=>e.id===a);return -1!==n&&e.splice(n,1),[...e]}if("RESET"===t.type)return[]},k=e=>{let{status:t,searchParam:a,tags:n,users:o,showAll:r,selectedQueueIds:c,updateCount:f,style:k}=e,j=y(),[T,C]=(0,s.useState)(1),[S,v]=(0,s.useReducer)(b,[]),{user:I}=(0,s.useContext)(m.V),{profile:w,queues:Z}=I;(0,s.useEffect)(()=>{v({type:"RESET"}),C(1)},[t,a,v,r,n,o,c]);let{tickets:E,hasMore:R,loading:N}=(0,g.Z)({pageNumber:T,searchParam:a,status:t,showAll:r,tags:JSON.stringify(n),users:JSON.stringify(o),queueIds:JSON.stringify(c)});(0,s.useEffect)(()=>{let e=Z.map(e=>e.id),t=E.filter(t=>e.indexOf(t.queueId)>-1);"user"===w?v({type:"LOAD_TICKETS",payload:t}):v({type:"LOAD_TICKETS",payload:E})},[E,t,a,Z,w]),(0,s.useEffect)(()=>{let e=localStorage.getItem("companyId"),a=(0,h.C)({companyId:e}),n=e=>(!e.userId||e.userId===I?.id||r)&&(!e.queueId||c.indexOf(e.queueId)>-1),i=e=>e.queueId&&-1===c.indexOf(e.queueId);return a.on("connect",()=>{t?a.emit("joinTickets",t):a.emit("joinNotification")}),a.on(`company-${e}-ticket`,e=>{console.log(e),"updateUnread"===e.action&&v({type:"RESET_UNREAD",payload:e.ticketId}),"update"===e.action&&n(e.ticket)&&v({type:"UPDATE_TICKET",payload:e.ticket}),"update"===e.action&&i(e.ticket)&&v({type:"DELETE_TICKET",payload:e.ticket.id}),"delete"===e.action&&v({type:"DELETE_TICKET",payload:e.ticketId})}),a.on(`company-${e}-appMessage`,e=>{let t=Z.map(e=>e.id);("user"!==w||-1!==t.indexOf(e.ticket.queue?.id)&&null!==e.ticket.queue)&&"create"===e.action&&n(e.ticket)&&v({type:"UPDATE_TICKET_UNREAD_MESSAGES",payload:e.ticket})}),a.on(`company-${e}-contact`,e=>{"update"===e.action&&v({type:"UPDATE_TICKET_CONTACT",payload:e.contact})}),()=>{a.disconnect()}},[t,r,I,c,n,o,w,Z]),(0,s.useEffect)(()=>{"function"==typeof f&&f(S.length)},[S]);let L=()=>{C(e=>e+1)};return i.jsx(d(),{className:j.ticketsListWrapper,style:k,children:i.jsx(d(),{square:!0,name:"closed",elevation:0,className:j.ticketsList,onScroll:e=>{if(!R||N)return;let{scrollTop:t,scrollHeight:a,clientHeight:n}=e.currentTarget;a-(t+100)<n&&L()},children:(0,i.jsxs)(l(),{style:{paddingTop:0},children:[0!==S.length||N?i.jsx(i.Fragment,{children:S.map(e=>i.jsx(p.Z,{ticket:e},e.id))}):(0,i.jsxs)("div",{className:j.noTicketsDiv,children:[i.jsx("span",{className:j.noTicketsTitle,children:x.a.t("ticketsList.noTicketsTitle")}),i.jsx("p",{className:j.noTicketsText,children:x.a.t("ticketsList.noTicketsMessage")})]}),N&&i.jsx(u.Z,{})]})})})};n()}catch(e){n(e)}})},17357:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{Z:()=>B});var i=a(20997),s=a(16689),o=a(14661),r=a(48308),l=a(40640),c=a.n(l),d=a(94202),p=a.n(d),u=a(87924),g=a.n(u),x=a(99033),m=a.n(x),h=a(12301),f=a.n(h),y=a(86489),b=a.n(y),k=a(23737),j=a.n(k),T=a(5797),C=a.n(T),S=a(36320),v=a.n(S),I=a(27943),w=a.n(I),Z=a(30363),E=a(41997),R=a(91903),N=a(92921),L=a(58582),A=a(20929),D=a(29700),M=a(282),W=a(76492),F=a(95030),q=e([Z,E,L,W,F]);[Z,E,L,W,F]=q.then?(await q)():q;let z=(0,r.makeStyles)(e=>({ticketsWrapper:{position:"relative",display:"flex",height:"100%",flexDirection:"column",overflow:"hidden",borderTopRightRadius:0,borderBottomRightRadius:0,borderRadius:0},tabsHeader:{flex:"none",backgroundColor:e.palette.tabHeaderBackground},tabsInternal:{flex:"none",backgroundColor:e.palette.tabHeaderBackground},settingsIcon:{alignSelf:"center",marginLeft:"auto",padding:8},tab:{minWidth:120,width:120},internalTab:{minWidth:120,width:120,padding:5},ticketOptionsBox:{display:"flex",justifyContent:"space-between",alignItems:"center",background:e.palette.optionsBackground,padding:e.spacing(1)},ticketSearchLine:{padding:e.spacing(1)},serachInputWrapper:{flex:1,background:e.palette.total,display:"flex",borderRadius:40,padding:4,marginRight:e.spacing(1)},searchIcon:{color:"grey",marginLeft:6,marginRight:6,alignSelf:"center"},searchInput:{flex:1,border:"none",borderRadius:30},insiderTabPanel:{height:"100%",marginTop:"-72px",paddingTop:"72px"},insiderDoubleTabPanel:{display:"flex",flexDirection:"column",marginTop:"-72px",paddingTop:"72px",height:"100%"},labelContainer:{width:"auto",padding:0},iconLabelWrapper:{flexDirection:"row","& > *:first-child":{marginBottom:"3px !important",marginRight:16}},insiderTabLabel:{[e.breakpoints.down(1600)]:{display:"none"}},smallFormControl:{"& .MuiOutlinedInput-input":{padding:"12px 10px"},"& .MuiInputLabel-outlined":{marginTop:"-6px"}}})),B=()=>{let e;let t=z(),a=(0,o.useNavigate)(),[n,r]=(0,s.useState)(""),[l,d]=(0,s.useState)("open"),[u,x]=(0,s.useState)("open"),[h,y]=(0,s.useState)(!1),[k,T]=(0,s.useState)(!1),S=(0,s.useRef)(),{user:I}=(0,s.useContext)(L.V),{profile:q}=I,[B,U]=(0,s.useState)(0),[O,_]=(0,s.useState)(0),P=I.queues.map(e=>e.id),[$,H]=(0,s.useState)(P||[]),[K,Q]=(0,s.useState)([]),[G,J]=(0,s.useState)([]);(0,s.useEffect)(()=>{"ADMIN"===I.profile.toUpperCase()&&T(!0)},[]),(0,s.useEffect)(()=>{"search"===l&&S.current.focus()},[l]);let V=e=>{if(u!==e)return{width:0,height:0}},Y=e=>{y(!1),void 0!==e&&void 0!==e.uuid&&a.push(`/tickets/${e.uuid}`)};return(0,i.jsxs)(c(),{elevation:0,variant:"outlined",className:t.ticketsWrapper,children:[i.jsx(Z.Z,{modalOpen:h,onClose:e=>{console.log("ticket",e),Y(e)}}),i.jsx(c(),{elevation:0,square:!0,className:t.tabsHeader,children:(0,i.jsxs)(m(),{value:l,onChange:(e,t)=>{d(t)},variant:"fullWidth",indicatorColor:"primary",textColor:"primary","aria-label":"icon label tabs example",children:[i.jsx(f(),{value:"open",icon:i.jsx(j(),{}),label:N.a.t("tickets.tabs.open.title"),classes:{root:t.tab}}),i.jsx(f(),{value:"closed",icon:i.jsx(C(),{}),label:N.a.t("tickets.tabs.closed.title"),classes:{root:t.tab}}),i.jsx(f(),{value:"search",icon:i.jsx(p(),{}),label:N.a.t("tickets.tabs.search.title"),classes:{root:t.tab}})]})}),(0,i.jsxs)(c(),{square:!0,elevation:0,className:t.ticketOptionsBox,children:["search"===l?(0,i.jsxs)("div",{className:t.serachInputWrapper,children:[i.jsx(p(),{className:t.searchIcon}),i.jsx(g(),{className:t.searchInput,inputRef:S,placeholder:N.a.t("tickets.search.placeholder"),type:"search",onChange:t=>{let a=t.target.value.toLowerCase();if(clearTimeout(e),""===a){r(a),d("open");return}e=setTimeout(()=>{r(a)},500)}})]}):(0,i.jsxs)(i.Fragment,{children:[i.jsx(M.Z,{variant:"outlined",color:"primary",onClick:()=>y(!0),children:N.a.t("ticketsManager.buttons.newTicket")}),i.jsx(A.m,{role:I.profile,perform:"tickets-manager:showall",yes:()=>i.jsx(v(),{label:N.a.t("tickets.buttons.showAll"),labelPlacement:"start",control:i.jsx(w(),{size:"small",checked:k,onChange:()=>T(e=>!e),name:"showAllTickets",color:"primary"})})})]}),i.jsx(D.Z,{style:{marginLeft:6},selectedQueueIds:$,userQueues:I?.queues,onChange:e=>H(e)})]}),(0,i.jsxs)(R.Z,{value:l,name:"open",className:t.ticketsWrapper,children:[(0,i.jsxs)(m(),{value:u,onChange:(e,t)=>{x(t)},indicatorColor:"primary",textColor:"primary",variant:"fullWidth",children:[i.jsx(f(),{label:i.jsx(b(),{className:t.badge,badgeContent:B,color:"primary",children:N.a.t("ticketsList.assignedHeader")}),value:"open"}),i.jsx(f(),{label:i.jsx(b(),{className:t.badge,badgeContent:O,color:"secondary",children:N.a.t("ticketsList.pendingHeader")}),value:"pending"})]}),(0,i.jsxs)(c(),{className:t.ticketsWrapper,children:[i.jsx(E.Z,{status:"open",showAll:k,selectedQueueIds:$,updateCount:e=>U(e),style:V("open")}),i.jsx(E.Z,{status:"pending",selectedQueueIds:$,updateCount:e=>_(e),style:V("pending")})]})]}),i.jsx(R.Z,{value:l,name:"closed",className:t.ticketsWrapper,children:i.jsx(E.Z,{status:"closed",showAll:!0,selectedQueueIds:$})}),(0,i.jsxs)(R.Z,{value:l,name:"search",className:t.ticketsWrapper,children:[i.jsx(W.E,{onFiltered:e=>{let t=e.map(e=>e.id);Q(t)}}),"admin"===q&&i.jsx(F.B,{onFiltered:e=>{let t=e.map(e=>e.id);J(t)}}),i.jsx(E.Z,{searchParam:n,showAll:!0,tags:K,users:G,selectedQueueIds:$})]})]})};n()}catch(e){n(e)}})},95030:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{B:()=>x});var i=a(20997),s=a(14310),o=a(16204),r=a(39803),l=a(88129),c=a.n(l),d=a(16689),p=a(151),u=a(38561),g=e([p]);function x({onFiltered:e,initialUsers:t}){let[a,n]=(0,d.useState)([]),[l,g]=(0,d.useState)([]);(0,d.useEffect)(()=>{(async function(){await x()})()},[]),(0,d.useEffect)(()=>{g([]),Array.isArray(t)&&Array.isArray(a)&&a.length>0&&m(t)},[t,a]);let x=async()=>{try{let{data:e}=await u.Z.get("/users/list"),t=e.map(e=>({id:e.id,name:e.name}));n(t)}catch(e){(0,p.Z)(e)}},m=async t=>{g(t),e(t)};return i.jsx(s.Z,{style:{padding:"0px 10px 10px"},children:i.jsx(c(),{multiple:!0,size:"small",options:a,value:l,onChange:(e,t,a)=>m(t),getOptionLabel:e=>e.name,getOptionSelected:(e,t)=>e?.id===t?.id||e?.name.toLowerCase()===t?.name.toLowerCase(),renderTags:(e,t)=>e.map((e,a)=>i.jsx(o.Z,{variant:"outlined",style:{backgroundColor:"#bfbfbf",textShadow:"1px 1px 1px #000",color:"white"},label:e.name,...t({index:a}),size:"small"})),renderInput:e=>i.jsx(r.Z,{...e,variant:"outlined",placeholder:"Filtro por Users"})})})}p=(g.then?(await g)():g)[0],n()}catch(e){n(e)}})}};