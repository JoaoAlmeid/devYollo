"use strict";exports.id=533,exports.ids=[533],exports.modules={79213:(e,t,a)=>{a.d(t,{Z:()=>c});var n=a(20997);a(16689);var r=a(48308),o=a(55223),s=a(282),i=a(95477);let l=(0,r.makeStyles)(e=>({button:{position:"relative"},buttonProgress:{color:o.green[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})),c=({loading:e,children:t,...a})=>{let r=l();return(0,n.jsxs)(s.Z,{className:r.button,disabled:e,...a,children:[t,e&&n.jsx(i.Z,{size:24,className:r.buttonProgress})]})}},20929:(e,t,a)=>{a.d(t,{m:()=>o});let n={user:{static:[]},admin:{static:["dashboard:view","drawer-admin-items:view","tickets-manager:showall","user-modal:editProfile","user-modal:editQueues","ticket-options:deleteTicket","contacts-page:deleteContact","connections-page:actionButtons","connections-page:addConnection","connections-page:editOrDeleteConnection"]}},r=(e,t,a)=>{let r=n[e];if(!r)return!1;let o=r.static;if(o&&o.includes(t))return!0;let s=r.dynamic;if(s){let e=s[t];return!!e&&e(a)}return!1},o=({role:e,perform:t,data:a,yes:n,no:o})=>r(e,t,a)?n():o();o.defaultProps={yes:()=>null,no:()=>null}},6133:(e,t,a)=>{a.d(t,{Z:()=>x});var n=a(20997);a(16689);var r=a(12610),o=a.n(r),s=a(81961),i=a.n(s),l=a(80929),c=a.n(l),d=a(46856),u=a.n(d),m=a(82400),h=a.n(m),p=a(54104),g=a.n(p),f=a(92921);let x=({title:e,children:t,open:a,onClose:r,onConfirm:s})=>(0,n.jsxs)(i(),{open:a,onClose:()=>r(!1),"aria-labelledby":"confirm-dialog",children:[n.jsx(h(),{id:"confirm-dialog",children:e}),n.jsx(u(),{dividers:!0,children:n.jsx(g(),{children:t})}),(0,n.jsxs)(c(),{children:[n.jsx(o(),{variant:"contained",onClick:()=>r(!1),color:"default",children:f.a.t("confirmationModal.buttons.cancel")}),n.jsx(o(),{variant:"contained",onClick:()=>{r(!1),s()},color:"secondary",children:f.a.t("confirmationModal.buttons.confirm")})]})]})},15928:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{Z:()=>z});var r=a(20997),o=a(16689),s=a(75609),i=a(2296),l=a(3590),c=a(48308),d=a(55223),u=a(12610),m=a.n(u),h=a(26481),p=a.n(h),g=a(81961),f=a.n(g),x=a(80929),y=a.n(x),v=a(46856),b=a.n(v),j=a(82400),I=a.n(j),S=a(54104),k=a.n(S),Z=a(83974),w=a.n(Z),C=a(4530),M=a.n(C),$=a(9069),T=a.n($),E=a(92921),A=a(38561),F=a(151),O=e([l,F]);[l,F]=O.then?(await O)():O;let P=(0,c.makeStyles)(e=>({root:{display:"flex",flexWrap:"wrap"},textField:{marginRight:e.spacing(1),flex:1},extraAttr:{display:"flex",justifyContent:"center",alignItems:"center"},btnWrapper:{position:"relative"},buttonProgress:{color:d.green[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})),N=s.object().shape({name:s.string().min(2,"Too Short!").max(50,"Too Long!").required("Required"),number:s.string().min(8,"Too Short!").max(50,"Too Long!"),email:s.string().email("Invalid email")}),z=({open:e,onClose:t,contactId:a,initialValues:n,onSave:s})=>{let c=P(),d=(0,o.useRef)(!0),u={name:"",number:"",email:""},[h,g]=(0,o.useState)(u);(0,o.useEffect)(()=>()=>{d.current=!1},[]),(0,o.useEffect)(()=>{(async()=>{if(n&&g(e=>({...e,...n})),a)try{let{data:e}=await A.Z.get(`/contacts/${a}`);d.current&&g(e)}catch(e){(0,F.Z)(e)}})()},[a,e,n]);let x=()=>{t(),g(u)},v=async e=>{try{if(a)await A.Z.put(`/contacts/${a}`,e),x();else{let{data:t}=await A.Z.post("/contacts",e);s&&s(t),x()}l.toast.success(E.a.t("contactModal.success"))}catch(e){(0,F.Z)(e)}};return r.jsx("div",{className:c.root,children:(0,r.jsxs)(f(),{open:e,onClose:x,maxWidth:"lg",scroll:"paper",children:[r.jsx(I(),{id:"form-dialog-title",children:a?`${E.a.t("contactModal.title.edit")}`:`${E.a.t("contactModal.title.add")}`}),r.jsx(i.Formik,{initialValues:h,enableReinitialize:!0,validationSchema:N,onSubmit:(e,t)=>{setTimeout(()=>{v(e),t.setSubmitting(!1)},400)},children:({values:e,errors:t,touched:n,isSubmitting:o})=>(0,r.jsxs)(i.Form,{children:[(0,r.jsxs)(b(),{dividers:!0,children:[r.jsx(k(),{variant:"subtitle1",gutterBottom:!0,children:E.a.t("contactModal.form.mainInfo")}),r.jsx(i.Field,{as:p(),label:E.a.t("contactModal.form.name"),name:"name",autoFocus:!0,error:n.name&&!!t.name,helperText:n.name&&t.name,variant:"outlined",margin:"dense",className:c.textField}),r.jsx(i.Field,{as:p(),label:E.a.t("contactModal.form.number"),name:"number",error:n.number&&!!t.number,helperText:n.number&&t.number,placeholder:"5513912344321",variant:"outlined",margin:"dense"}),r.jsx("div",{children:r.jsx(i.Field,{as:p(),label:E.a.t("contactModal.form.email"),name:"email",error:n.email&&!!t.email,helperText:n.email&&t.email,placeholder:"Email address",fullWidth:!0,margin:"dense",variant:"outlined"})}),r.jsx(k(),{style:{marginBottom:8,marginTop:12},variant:"subtitle1",children:E.a.t("contactModal.form.extraInfo")}),r.jsx(i.FieldArray,{name:"extraInfo",children:({push:t,remove:a})=>(0,r.jsxs)(r.Fragment,{children:[e.extraInfo&&e.extraInfo.length>0&&e.extraInfo.map((e,t)=>(0,r.jsxs)("div",{className:c.extraAttr,children:[r.jsx(i.Field,{as:p(),label:E.a.t("contactModal.form.extraName"),name:`extraInfo[${t}].name`,variant:"outlined",margin:"dense",className:c.textField}),r.jsx(i.Field,{as:p(),label:E.a.t("contactModal.form.extraValue"),name:`extraInfo[${t}].value`,variant:"outlined",margin:"dense",className:c.textField}),r.jsx(w(),{size:"small",onClick:()=>a(t),children:r.jsx(M(),{})})]},`${t}-info`)),r.jsx("div",{className:c.extraAttr,children:r.jsx(m(),{style:{flex:1,marginTop:8},variant:"outlined",color:"primary",onClick:()=>t({name:"",value:""}),children:`+ ${E.a.t("contactModal.buttons.addExtraInfo")}`})})]})})]}),(0,r.jsxs)(y(),{children:[r.jsx(m(),{onClick:x,color:"secondary",disabled:o,variant:"outlined",children:E.a.t("contactModal.buttons.cancel")}),(0,r.jsxs)(m(),{type:"submit",color:"primary",disabled:o,variant:"contained",className:c.btnWrapper,children:[a?`${E.a.t("contactModal.buttons.okEdit")}`:`${E.a.t("contactModal.buttons.okAdd")}`,o&&r.jsx(T(),{size:24,className:c.buttonProgress})]})]})]})})]})})};n()}catch(e){n(e)}})},30363:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{Z:()=>N});var r=a(20997),o=a(16689),s=a.n(o),i=a(12610),l=a.n(i),c=a(26481),d=a.n(c),u=a(81961),m=a.n(u),h=a(80929),p=a.n(h),g=a(46856),f=a.n(g),x=a(82400),y=a.n(x),v=a(88129),b=a.n(v),j=a(9069),I=a.n(j),S=a(92921),k=a(38561),Z=a(79213),w=a(15928),C=a(151),M=a(58582),$=a(41749),T=a(94924),E=a(85639),A=a(95757),F=a(3590),O=e([w,C,M,F]);[w,C,M,F]=O.then?(await O)():O;let P=(0,v.createFilterOptions)({trim:!0}),N=({modalOpen:e,onClose:t,initialContact:a})=>{let[n,i]=(0,o.useState)([]),[c,u]=(0,o.useState)(!1),[h,g]=(0,o.useState)(""),[x,v]=(0,o.useState)(null),[j,O]=(0,o.useState)(""),[N,z]=(0,o.useState)({}),[B,D]=(0,o.useState)(!1),{user:q}=(0,o.useContext)(M.V);(0,o.useEffect)(()=>{a?.id!==void 0&&(i([a]),v(a))},[a]),(0,o.useEffect)(()=>{if(!e||h.length<3){u(!1);return}u(!0);let t=setTimeout(()=>{(async()=>{try{let{data:e}=await k.Z.get("contacts",{params:{searchParam:h}});i(e.contacts),u(!1)}catch(e){u(!1),(0,C.Z)(e)}})()},500);return()=>clearTimeout(t)},[h,e]);let V=()=>{t(),g(""),v(null)},L=async e=>{if(e){if(""===j&&"admin"!==q.profile){F.toast.error("Selecione uma fila");return}u(!0);try{let{data:a}=await k.Z.post("/tickets",{contactId:e,queueId:""!==j?j:null,userId:q.id,status:"open"});t(a)}catch(e){(0,C.Z)(e)}u(!1)}},W=(e,t)=>{t?.number?v(t):t?.name&&(z({name:t.name}),D(!0))};return(0,r.jsxs)(r.Fragment,{children:[r.jsx(w.Z,{open:B,initialValues:N,onClose:()=>{D(!1)},onSave:e=>{L(e.id)}}),(0,r.jsxs)(m(),{open:e,onClose:V,children:[r.jsx(y(),{id:"form-dialog-title",children:S.a.t("newTicketModal.title")}),r.jsx(f(),{dividers:!0,children:(0,r.jsxs)($.Z,{style:{width:300},container:!0,spacing:2,children:[void 0===a||void 0===a.id?r.jsx($.Z,{xs:12,item:!0,children:r.jsx(b(),{fullWidth:!0,options:n,loading:c,clearOnBlur:!0,autoHighlight:!0,freeSolo:!0,clearOnEscape:!0,getOptionLabel:e=>e.number?`${e.name} - ${e.number}`:`${e.name}`,renderOption:e=>e.number?`${e.name} - ${e.number}`:`${S.a.t("newTicketModal.add")} ${e.name}`,filterOptions:(e,t)=>{let a=P(e,t);return""!==t.inputValue&&!c&&h.length>=3&&a.push({name:`${t.inputValue}`}),a},onChange:(e,t)=>W(e,t),renderInput:e=>r.jsx(d(),{...e,label:S.a.t("newTicketModal.fieldLabel"),variant:"outlined",autoFocus:!0,onChange:e=>g(e.target.value),onKeyPress:e=>{!c&&x&&"Enter"===e.key&&L(x.id)},InputProps:{...e.InputProps,endAdornment:(0,r.jsxs)(s().Fragment,{children:[c?r.jsx(I(),{color:"inherit",size:20}):null,e.InputProps.endAdornment]})}})})}):null,r.jsx($.Z,{xs:12,item:!0,children:r.jsx(T.Z,{fullWidth:!0,displayEmpty:!0,variant:"outlined",value:j,onChange:e=>{O(e.target.value)},MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},getContentAnchorEl:null},renderValue:()=>""===j?"Selecione uma fila":q.queues.find(e=>e.id===j).name,children:q.queues?.length>0&&q.queues.map((e,t)=>r.jsx(E.Z,{dense:!0,value:e.id,children:r.jsx(A.Z,{primary:e.name})},t))})})]})}),(0,r.jsxs)(p(),{children:[r.jsx(l(),{onClick:V,color:"secondary",disabled:c,variant:"outlined",children:S.a.t("newTicketModal.buttons.cancel")}),r.jsx(Z.Z,{variant:"contained",type:"button",disabled:!x,onClick:()=>L(x.id),color:"primary",loading:c,children:S.a.t("newTicketModal.buttons.ok")})]})]})]})};n()}catch(e){n(e)}})},58582:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{V:()=>i}),a(20997);var r=a(16689),o=a(85425),s=e([o]);o=(s.then?(await s)():s)[0];let i=(0,r.createContext)();n()}catch(e){n(e)}})},151:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{Z:()=>c});var r=a(3590),o=a(92921),s=a(97026),i=a.n(s),l=e([r]);r=(l.then?(await l)():l)[0];let c=e=>{let t=e.response?.data?.error;if(t){if(o.a.exists(`backendErrors.${t}`)){r.toast.error(o.a.t(`backendErrors.${t}`),{toastId:t,autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"});return}r.toast.error(t,{toastId:t,autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"});return}if(i()(e)){r.toast.error(e);return}r.toast.error("An error occurred!")};n()}catch(e){n(e)}})},85425:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{Z:()=>y});var r=a(16689),o=a(14661),s=a(98210),i=a.n(s),l=a(35599),c=a.n(l),d=a(3590),u=a(92921),m=a(38561),h=a(151),p=a(7405),g=a(32245),f=a.n(g),x=e([d,h,p]);[d,h,p]=x.then?(await x)():x;let y=()=>{let e=(0,o.useNavigate)(),[t,a]=(0,r.useState)(!1),[n,s]=(0,r.useState)(!0),[l,g]=(0,r.useState)({});m.Z.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${JSON.parse(t)}`,a(!0)),e},e=>{Promise.reject(e)}),m.Z.interceptors.response.use(e=>e,async e=>{let t=e.config;if(e?.response?.status===403&&!t._retry){t._retry=!0;let{data:e}=await m.Z.post("/auth/refresh_token");return e&&(localStorage.setItem("token",JSON.stringify(e.token)),m.Z.defaults.headers.Authorization=`Bearer ${e.token}`),(0,m.Z)(t)}return e?.response?.status===401&&(localStorage.removeItem("token"),localStorage.removeItem("companyId"),m.Z.defaults.headers.Authorization=void 0,a(!1)),Promise.reject(e)}),(0,r.useEffect)(()=>{let e=localStorage.getItem("token");(async()=>{if(e)try{let{data:e}=await m.Z.post("/auth/refresh_token");m.Z.defaults.headers.Authorization=`Bearer ${e.token}`,a(!0),g(e.user)}catch(e){(0,h.Z)(e)}s(!1)})()},[]),(0,r.useEffect)(()=>{let e=localStorage.getItem("companyId");if(e){let t=(0,p.C)({companyId:e});return t.on(`company-${e}-user`,e=>{"update"===e.action&&e.user.id===l.id&&g(e.user)}),()=>{t.disconnect()}}},[l]);let x=async t=>{s(!0);try{let{data:l}=await m.Z.post("/auth/login",t),{user:{companyId:p,id:x,company:y}}=l;if(i()(y,"settings")&&c()(y.settings)){let e=y.settings.find(e=>"campaignsEnabled"===e.key);e&&"true"===e.value&&localStorage.setItem("cshow",null)}f().locale("pt-br");let v=l.user.company.dueDate;f()(f()()).format("DD/MM/yyyy");let b=f()(v).format("DD/MM/yyyy");var n=f()(v).diff(f()(f()()).format()),r=f()(f()().format()).isBefore(v),o=f().duration(n).asDays();!0===r?(localStorage.setItem("token",JSON.stringify(l.token)),localStorage.setItem("companyId",p),localStorage.setItem("userId",x),localStorage.setItem("companyDueDate",b),m.Z.defaults.headers.Authorization=`Bearer ${l.token}`,g(l.user),a(!0),d.toast.success(u.a.t("auth.toasts.success")),5>Math.round(o)&&d.toast.warn(`Sua assinatura vence em ${Math.round(o)} ${1===Math.round(o)?"dia":"dias"} `),e.push("/tickets")):(0,h.Z)(`Opss! Sua assinatura venceu ${b}.
Entre em contato com o Suporte para mais informa\xe7\xf5es! `),s(!1)}catch(e){(0,h.Z)(e),s(!1)}},y=async()=>{s(!0);try{await m.Z.delete("/auth/logout"),a(!1),g({}),localStorage.removeItem("token"),localStorage.removeItem("companyId"),localStorage.removeItem("userId"),localStorage.removeItem("cshow"),m.Z.defaults.headers.Authorization=void 0,s(!1),e.push("/login")}catch(e){(0,h.Z)(e),s(!1)}},v=async()=>{try{let{data:e}=await m.Z.get("/auth/me");return e}catch(e){(0,h.Z)(e)}};return{isAuth:t,user:l,loading:n,handleLogin:x,handleLogout:y,getCurrentUserInfo:v}};n()}catch(e){n(e)}})},7405:(e,t,a)=>{a.a(e,async(e,n)=>{try{a.d(t,{C:()=>l});var r=a(14612),o=a(75795),s=a.n(o),i=e([r]);function l(e){return localStorage.getItem("userId")&&localStorage.getItem("userId"),(0,r.default)(process.env.REACT_APP_BACKEND_URL,{transports:["websocket","polling","flashsocket"],pingTimeout:18e3,pingInterval:18e3,query:s()(e)?{...e}:{userId:e.userId}})}r=(i.then?(await i)():i)[0],n()}catch(e){n(e)}})}};