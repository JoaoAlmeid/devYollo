"use strict";exports.id=4096,exports.ids=[4096],exports.modules={14310:(e,t,a)=>{a.d(t,{Z:()=>l});var r=a(95027),o=a(87462),s=a(43349),n=a(90953),i=(0,r.styleFunctionSx)((0,r.compose)(r.borders,r.display,r.flexbox,r.grid,r.positions,r.palette,r.shadows,r.sizing,r.spacing,r.typography));let l=(function(e){var t=(0,s.styled)("div");return function(e,a){return t(e,(0,o.Z)({defaultTheme:n.Z},a))}})(0)(i,{name:"MuiBox"})},7397:(e,t,a)=>{a.d(t,{Z:()=>m});var r=a(87462),o=a(91),s=a(16689);a(580);var n=a(68103),i=a.n(n),l=a(22318),d=a(52543),c=a(15736),u=s.forwardRef(function(e,t){var a=e.children,n=e.classes,d=e.className,u=e.component,m=e.disablePointerEvents,p=e.disableTypography,h=e.position,g=e.variant,f=(0,o.Z)(e,["children","classes","className","component","disablePointerEvents","disableTypography","position","variant"]),v=(0,c.Y)()||{},y=g;return g&&v.variant,v&&!y&&(y=v.variant),s.createElement(c.Z.Provider,{value:null},s.createElement(void 0===u?"div":u,(0,r.Z)({className:i()(n.root,d,"end"===h?n.positionEnd:n.positionStart,void 0!==m&&m&&n.disablePointerEvents,v.hiddenLabel&&n.hiddenLabel,"filled"===y&&n.filled,"dense"===v.margin&&n.marginDense),ref:t},f),"string"!=typeof a||void 0!==p&&p?a:s.createElement(l.Z,{color:"textSecondary"},a)))});let m=(0,d.Z)({root:{display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap"},filled:{"&$positionStart:not($hiddenLabel)":{marginTop:16}},positionStart:{marginRight:8},positionEnd:{marginLeft:8},disablePointerEvents:{pointerEvents:"none"},hiddenLabel:{},marginDense:{}},{name:"MuiInputAdornment"})(u)},58582:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{V:()=>i}),a(20997);var o=a(16689),s=a(85425),n=e([s]);s=(n.then?(await n)():n)[0];let i=(0,o.createContext)();r()}catch(e){r(e)}})},151:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{Z:()=>d});var o=a(3590),s=a(92921),n=a(97026),i=a.n(n),l=e([o]);o=(l.then?(await l)():l)[0];let d=e=>{let t=e.response?.data?.error;if(t){if(s.a.exists(`backendErrors.${t}`)){o.toast.error(s.a.t(`backendErrors.${t}`),{toastId:t,autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"});return}o.toast.error(t,{toastId:t,autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"});return}if(i()(e)){o.toast.error(e);return}o.toast.error("An error occurred!")};r()}catch(e){r(e)}})},85425:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{Z:()=>y});var o=a(16689),s=a(14661),n=a(98210),i=a.n(n),l=a(35599),d=a.n(l),c=a(3590),u=a(92921),m=a(38561),p=a(151),h=a(7405),g=a(32245),f=a.n(g),v=e([c,p,h]);[c,p,h]=v.then?(await v)():v;let y=()=>{let e=(0,s.useNavigate)(),[t,a]=(0,o.useState)(!1),[r,n]=(0,o.useState)(!0),[l,g]=(0,o.useState)({});m.Z.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${JSON.parse(t)}`,a(!0)),e},e=>{Promise.reject(e)}),m.Z.interceptors.response.use(e=>e,async e=>{let t=e.config;if(e?.response?.status===403&&!t._retry){t._retry=!0;let{data:e}=await m.Z.post("/auth/refresh_token");return e&&(localStorage.setItem("token",JSON.stringify(e.token)),m.Z.defaults.headers.Authorization=`Bearer ${e.token}`),(0,m.Z)(t)}return e?.response?.status===401&&(localStorage.removeItem("token"),localStorage.removeItem("companyId"),m.Z.defaults.headers.Authorization=void 0,a(!1)),Promise.reject(e)}),(0,o.useEffect)(()=>{let e=localStorage.getItem("token");(async()=>{if(e)try{let{data:e}=await m.Z.post("/auth/refresh_token");m.Z.defaults.headers.Authorization=`Bearer ${e.token}`,a(!0),g(e.user)}catch(e){(0,p.Z)(e)}n(!1)})()},[]),(0,o.useEffect)(()=>{let e=localStorage.getItem("companyId");if(e){let t=(0,h.C)({companyId:e});return t.on(`company-${e}-user`,e=>{"update"===e.action&&e.user.id===l.id&&g(e.user)}),()=>{t.disconnect()}}},[l]);let v=async t=>{n(!0);try{let{data:l}=await m.Z.post("/auth/login",t),{user:{companyId:h,id:v,company:y}}=l;if(i()(y,"settings")&&d()(y.settings)){let e=y.settings.find(e=>"campaignsEnabled"===e.key);e&&"true"===e.value&&localStorage.setItem("cshow",null)}f().locale("pt-br");let x=l.user.company.dueDate;f()(f()()).format("DD/MM/yyyy");let b=f()(x).format("DD/MM/yyyy");var r=f()(x).diff(f()(f()()).format()),o=f()(f()().format()).isBefore(x),s=f().duration(r).asDays();!0===o?(localStorage.setItem("token",JSON.stringify(l.token)),localStorage.setItem("companyId",h),localStorage.setItem("userId",v),localStorage.setItem("companyDueDate",b),m.Z.defaults.headers.Authorization=`Bearer ${l.token}`,g(l.user),a(!0),c.toast.success(u.a.t("auth.toasts.success")),5>Math.round(s)&&c.toast.warn(`Sua assinatura vence em ${Math.round(s)} ${1===Math.round(s)?"dia":"dias"} `),e.push("/tickets")):(0,p.Z)(`Opss! Sua assinatura venceu ${b}.
Entre em contato com o Suporte para mais informa\xe7\xf5es! `),n(!1)}catch(e){(0,p.Z)(e),n(!1)}},y=async()=>{n(!0);try{await m.Z.delete("/auth/logout"),a(!1),g({}),localStorage.removeItem("token"),localStorage.removeItem("companyId"),localStorage.removeItem("userId"),localStorage.removeItem("cshow"),m.Z.defaults.headers.Authorization=void 0,n(!1),e.push("/login")}catch(e){(0,p.Z)(e),n(!1)}},x=async()=>{try{let{data:e}=await m.Z.get("/auth/me");return e}catch(e){(0,p.Z)(e)}};return{isAuth:t,user:l,loading:r,handleLogin:v,handleLogout:y,getCurrentUserInfo:x}};r()}catch(e){r(e)}})},74846:(e,t,a)=>{a.d(t,{Y:()=>s});var r=a(32245),o=a.n(r);function s(){return{dateToClient:function(e){return o()(e).isValid()?o()(e).format("DD/MM/YYYY"):e},datetimeToClient:function(e){return o()(e).isValid()?o()(e).format("DD/MM/YYYY HH:mm"):e},dateToDatabase:function(e){return o()(e,"DD/MM/YYYY").isValid()?o()(e).format("YYYY-MM-DD HH:mm:ss"):e}}}},24096:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>b});var o=a(20997),s=a(16689),n=a(41120),i=a(79895),l=a(14310),d=a(22318),c=a(64436),u=a(38799),m=a(7397),p=a(17812),h=a(4662),g=a.n(h),f=a(58582),v=a(74846),y=a(38561);a(55223);var x=e([f]);f=(x.then?(await x)():x)[0];let Z=(0,n.Z)(e=>({mainContainer:{display:"flex",flexDirection:"column",position:"relative",flex:1,overflow:"hidden",borderRadius:0,height:"100%",borderLeft:"1px solid rgba(0, 0, 0, 0.12)"},messageList:{position:"relative",overflowY:"auto",height:"100%",...e.scrollbarStyles,backgroundColor:e.palette.chatlist},inputArea:{position:"relative",height:"auto"},input:{padding:"20px"},buttonSend:{margin:e.spacing(1)},boxLeft:{padding:"10px 10px 5px",margin:"10px",position:"relative",backgroundColor:"blue",maxWidth:300,borderRadius:10,borderBottomLeftRadius:0,border:"1px solid rgba(0, 0, 0, 0.12)"},boxRight:{padding:"10px 10px 5px",margin:"10px 10px 10px auto",position:"relative",backgroundColor:"green",textAlign:"right",maxWidth:300,borderRadius:10,borderBottomRightRadius:0,border:"1px solid rgba(0, 0, 0, 0.12)"}}));function b({chat:e,messages:t,handleSendMessage:a,handleLoadMore:r,scrollToBottomRef:n,pageInfo:h,loading:x}){let b=Z(),{user:S}=(0,s.useContext)(f.V),{datetimeToClient:I}=(0,v.Y)(),k=(0,s.useRef)(),[w,D]=(0,s.useState)(""),E=()=>{k.current&&k.current.scrollIntoView({})},Y=e=>void 0!==e?e.users.find(e=>e.userId===S.id).unreads>0:0;return(0,s.useEffect)(()=>{if(Y(e)>0)try{y.Z.post(`/chats/${e.id}/read`,{userId:S.id})}catch(e){}n.current=E},[]),(0,o.jsxs)(i.Z,{className:b.mainContainer,children:[(0,o.jsxs)("div",{onScroll:e=>{let{scrollTop:t}=e.currentTarget;h.hasMore&&!x&&t<600&&r()},className:b.messageList,children:[Array.isArray(t)&&t.map((e,t)=>e.senderId===S.id?(0,o.jsxs)(l.Z,{className:b.boxRight,children:[o.jsx(d.Z,{variant:"subtitle2",children:e.sender.name}),e.message,o.jsx(d.Z,{variant:"caption",display:"block",children:I(e.createdAt)})]},t):(0,o.jsxs)(l.Z,{className:b.boxLeft,children:[o.jsx(d.Z,{variant:"subtitle2",children:e.sender.name}),e.message,o.jsx(d.Z,{variant:"caption",display:"block",children:I(e.createdAt)})]},t)),o.jsx("div",{ref:k})]}),o.jsx("div",{className:b.inputArea,children:o.jsx(c.Z,{variant:"outlined",fullWidth:!0,children:o.jsx(u.Z,{multiline:!0,value:w,onKeyUp:e=>{"Enter"===e.key&&""!==w.trim()&&(a(w),D(""))},onChange:e=>D(e.target.value),className:b.input,endAdornment:o.jsx(m.Z,{position:"end",children:o.jsx(p.Z,{onClick:()=>{""!==w.trim()&&(a(w),D(""))},className:b.buttonSend,children:o.jsx(g(),{})})})})})})]})}r()}catch(e){r(e)}})},7405:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{C:()=>l});var o=a(14612),s=a(75795),n=a.n(s),i=e([o]);function l(e){return localStorage.getItem("userId")&&localStorage.getItem("userId"),(0,o.default)(process.env.REACT_APP_BACKEND_URL,{transports:["websocket","polling","flashsocket"],pingTimeout:18e3,pingInterval:18e3,query:n()(e)?{...e}:{userId:e.userId}})}o=(i.then?(await i)():i)[0],r()}catch(e){r(e)}})}};