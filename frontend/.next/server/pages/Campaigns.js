"use strict";(()=>{var e={};e.id=659,e.ids=[659,660],e.modules={14310:(e,a,t)=>{t.d(a,{Z:()=>l});var r=t(95027),i=t(87462),n=t(43349),s=t(90953),o=(0,r.styleFunctionSx)((0,r.compose)(r.borders,r.display,r.flexbox,r.grid,r.positions,r.palette,r.shadows,r.sizing,r.spacing,r.typography));let l=(function(e){var a=(0,n.styled)("div");return function(e,t){return a(e,(0,i.Z)({defaultTheme:s.Z},t))}})(0)(o,{name:"MuiBox"})},64436:(e,a,t)=>{t.d(a,{Z:()=>g});var r=t(87462),i=t(91),n=t(16689);t(580);var s=t(68103),o=t.n(s),l=t(36519),c=t(52543),d=t(93871),m=t(83711),u=t(15736),p=n.forwardRef(function(e,a){var t,s=e.children,c=e.classes,p=e.className,g=e.color,x=e.component,h=e.disabled,f=void 0!==h&&h,j=e.error,v=e.fullWidth,y=void 0!==v&&v,b=e.focused,Z=e.hiddenLabel,S=e.margin,A=void 0===S?"none":S,C=e.required,w=e.size,I=e.variant,M=(0,i.Z)(e,["children","classes","className","color","component","disabled","error","fullWidth","focused","hiddenLabel","margin","required","size","variant"]),q=n.useState(function(){var e=!1;return s&&n.Children.forEach(s,function(a){if((0,m.Z)(a,["Input","Select"])){var t=(0,m.Z)(a,["Select"])?a.props.input:a;t&&(0,l.B7)(t.props)&&(e=!0)}}),e}),N=q[0],D=q[1],E=n.useState(function(){var e=!1;return s&&n.Children.forEach(s,function(a){(0,m.Z)(a,["Input","Select"])&&(0,l.vd)(a.props,!0)&&(e=!0)}),e}),k=E[0],P=E[1],F=n.useState(!1),T=F[0],$=F[1],L=void 0!==b?b:T;f&&L&&$(!1);var W=n.useCallback(function(){P(!0)},[]),z=n.useCallback(function(){P(!1)},[]);return n.createElement(u.Z.Provider,{value:{adornedStart:N,setAdornedStart:D,color:void 0===g?"primary":g,disabled:f,error:void 0!==j&&j,filled:k,focused:L,fullWidth:y,hiddenLabel:void 0!==Z&&Z,margin:("small"===w?"dense":void 0)||A,onBlur:function(){$(!1)},onEmpty:z,onFilled:W,onFocus:function(){$(!0)},registerEffect:t,required:void 0!==C&&C,variant:void 0===I?"standard":I}},n.createElement(void 0===x?"div":x,(0,r.Z)({className:o()(c.root,p,"none"!==A&&c["margin".concat((0,d.Z)(A))],y&&c.fullWidth),ref:a},M),s))});let g=(0,c.Z)({root:{display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},marginNormal:{marginTop:16,marginBottom:8},marginDense:{marginTop:8,marginBottom:4},fullWidth:{width:"100%"}},{name:"MuiFormControl"})(p)},41749:(e,a,t)=>{t.d(a,{Z:()=>p});var r=t(91),i=t(87462),n=t(16689);t(580);var s=t(68103),o=t.n(s),l=t(52543),c=[0,1,2,3,4,5,6,7,8,9,10],d=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12];function m(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=parseFloat(e);return"".concat(t/a).concat(String(e).replace(String(t),"")||"px")}var u=n.forwardRef(function(e,a){var t=e.alignContent,s=void 0===t?"stretch":t,l=e.alignItems,c=void 0===l?"stretch":l,d=e.classes,m=e.className,u=e.component,p=e.container,g=e.direction,x=void 0===g?"row":g,h=e.item,f=e.justify,j=e.justifyContent,v=void 0===j?"flex-start":j,y=e.lg,b=void 0!==y&&y,Z=e.md,S=void 0!==Z&&Z,A=e.sm,C=void 0!==A&&A,w=e.spacing,I=void 0===w?0:w,M=e.wrap,q=void 0===M?"wrap":M,N=e.xl,D=void 0!==N&&N,E=e.xs,k=void 0!==E&&E,P=e.zeroMinWidth,F=(0,r.Z)(e,["alignContent","alignItems","classes","className","component","container","direction","item","justify","justifyContent","lg","md","sm","spacing","wrap","xl","xs","zeroMinWidth"]),T=o()(d.root,m,void 0!==p&&p&&[d.container,0!==I&&d["spacing-xs-".concat(String(I))]],void 0!==h&&h&&d.item,void 0!==P&&P&&d.zeroMinWidth,"row"!==x&&d["direction-xs-".concat(String(x))],"wrap"!==q&&d["wrap-xs-".concat(String(q))],"stretch"!==c&&d["align-items-xs-".concat(String(c))],"stretch"!==s&&d["align-content-xs-".concat(String(s))],"flex-start"!==(f||v)&&d["justify-content-xs-".concat(String(f||v))],!1!==k&&d["grid-xs-".concat(String(k))],!1!==C&&d["grid-sm-".concat(String(C))],!1!==S&&d["grid-md-".concat(String(S))],!1!==b&&d["grid-lg-".concat(String(b))],!1!==D&&d["grid-xl-".concat(String(D))]);return n.createElement(void 0===u?"div":u,(0,i.Z)({className:T,ref:a},F))});let p=(0,l.Z)(function(e){var a;return(0,i.Z)({root:{},container:{boxSizing:"border-box",display:"flex",flexWrap:"wrap",width:"100%"},item:{boxSizing:"border-box",margin:"0"},zeroMinWidth:{minWidth:0},"direction-xs-column":{flexDirection:"column"},"direction-xs-column-reverse":{flexDirection:"column-reverse"},"direction-xs-row-reverse":{flexDirection:"row-reverse"},"wrap-xs-nowrap":{flexWrap:"nowrap"},"wrap-xs-wrap-reverse":{flexWrap:"wrap-reverse"},"align-items-xs-center":{alignItems:"center"},"align-items-xs-flex-start":{alignItems:"flex-start"},"align-items-xs-flex-end":{alignItems:"flex-end"},"align-items-xs-baseline":{alignItems:"baseline"},"align-content-xs-center":{alignContent:"center"},"align-content-xs-flex-start":{alignContent:"flex-start"},"align-content-xs-flex-end":{alignContent:"flex-end"},"align-content-xs-space-between":{alignContent:"space-between"},"align-content-xs-space-around":{alignContent:"space-around"},"justify-content-xs-center":{justifyContent:"center"},"justify-content-xs-flex-end":{justifyContent:"flex-end"},"justify-content-xs-space-between":{justifyContent:"space-between"},"justify-content-xs-space-around":{justifyContent:"space-around"},"justify-content-xs-space-evenly":{justifyContent:"space-evenly"}},(a={},c.forEach(function(t){var r=e.spacing(t);0!==r&&(a["spacing-".concat("xs","-").concat(t)]={margin:"-".concat(m(r,2)),width:"calc(100% + ".concat(m(r),")"),"& > $item":{padding:m(r,2)}})}),a),e.breakpoints.keys.reduce(function(a,t){var r;return r={},d.forEach(function(e){var a="grid-".concat(t,"-").concat(e);if(!0===e){r[a]={flexBasis:0,flexGrow:1,maxWidth:"100%"};return}if("auto"===e){r[a]={flexBasis:"auto",flexGrow:0,maxWidth:"none"};return}var i="".concat(Math.round(e/12*1e8)/1e6,"%");r[a]={flexBasis:i,flexGrow:0,maxWidth:i}}),"xs"===t?(0,i.Z)(a,r):a[e.breakpoints.up(t)]=r,a},{}))},{name:"MuiGrid"})(u)},85161:(e,a,t)=>{t.d(a,{Z:()=>x});var r=t(87462),i=t(91),n=t(16689);t(580);var s=t(68103),o=t.n(s),l=t(89345),c=t(22601),d=t(52543),m=t(93871),u=n.forwardRef(function(e,a){var t=e.children,s=e.classes,d=e.className,u=(e.color,e.component),p=(e.disabled,e.error,e.filled,e.focused,e.required,(0,i.Z)(e,["children","classes","className","color","component","disabled","error","filled","focused","required"])),g=(0,c.Z)(),x=(0,l.Z)({props:e,muiFormControl:g,states:["color","required","focused","disabled","error","filled"]});return n.createElement(void 0===u?"label":u,(0,r.Z)({className:o()(s.root,s["color".concat((0,m.Z)(x.color||"primary"))],d,x.disabled&&s.disabled,x.error&&s.error,x.filled&&s.filled,x.focused&&s.focused,x.required&&s.required),ref:a},p),t,x.required&&n.createElement("span",{"aria-hidden":!0,className:o()(s.asterisk,x.error&&s.error)},"â€‰","*"))});let p=(0,d.Z)(function(e){return{root:(0,r.Z)({color:e.palette.text.secondary},e.typography.body1,{lineHeight:1,padding:0,"&$focused":{color:e.palette.primary.main},"&$disabled":{color:e.palette.text.disabled},"&$error":{color:e.palette.error.main}}),colorSecondary:{"&$focused":{color:e.palette.secondary.main}},focused:{},disabled:{},error:{},filled:{},required:{},asterisk:{"&$error":{color:e.palette.error.main}}}},{name:"MuiFormLabel"})(u);var g=n.forwardRef(function(e,a){var t=e.classes,s=e.className,d=e.disableAnimation,m=(e.margin,e.shrink),u=(e.variant,(0,i.Z)(e,["classes","className","disableAnimation","margin","shrink","variant"])),g=(0,c.Z)(),x=m;void 0===x&&g&&(x=g.filled||g.focused||g.adornedStart);var h=(0,l.Z)({props:e,muiFormControl:g,states:["margin","variant"]});return n.createElement(p,(0,r.Z)({"data-shrink":x,className:o()(t.root,s,g&&t.formControl,!(void 0!==d&&d)&&t.animated,x&&t.shrink,"dense"===h.margin&&t.marginDense,{filled:t.filled,outlined:t.outlined}[h.variant]),classes:{focused:t.focused,disabled:t.disabled,error:t.error,required:t.required,asterisk:t.asterisk},ref:a},u))});let x=(0,d.Z)(function(e){return{root:{display:"block",transformOrigin:"top left"},focused:{},disabled:{},error:{},required:{},asterisk:{},formControl:{position:"absolute",left:0,top:0,transform:"translate(0, 24px) scale(1)"},marginDense:{transform:"translate(0, 21px) scale(1)"},shrink:{transform:"translate(0, 1.5px) scale(0.75)",transformOrigin:"top left"},animated:{transition:e.transitions.create(["color","transform"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})},filled:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 20px) scale(1)","&$marginDense":{transform:"translate(12px, 17px) scale(1)"},"&$shrink":{transform:"translate(12px, 10px) scale(0.75)","&$marginDense":{transform:"translate(12px, 7px) scale(0.75)"}}},outlined:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 20px) scale(1)","&$marginDense":{transform:"translate(14px, 12px) scale(1)"},"&$shrink":{transform:"translate(14px, -6px) scale(0.75)"}}}},{name:"MuiInputLabel"})(g)},37837:(e,a,t)=>{t.a(e,async(e,r)=>{try{t.r(a),t.d(a,{config:()=>f,default:()=>p,getServerSideProps:()=>h,getStaticPaths:()=>x,getStaticProps:()=>g,reportWebVitals:()=>j,routeModule:()=>A,unstable_getServerProps:()=>Z,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>b,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>v});var i=t(87093),n=t(35244),s=t(1323),o=t(55388),l=t.n(o),c=t(16769),d=t.n(c),m=t(67225),u=e([m]);m=(u.then?(await u)():u)[0];let p=(0,s.l)(m,"default"),g=(0,s.l)(m,"getStaticProps"),x=(0,s.l)(m,"getStaticPaths"),h=(0,s.l)(m,"getServerSideProps"),f=(0,s.l)(m,"config"),j=(0,s.l)(m,"reportWebVitals"),v=(0,s.l)(m,"unstable_getStaticProps"),y=(0,s.l)(m,"unstable_getStaticPaths"),b=(0,s.l)(m,"unstable_getStaticParams"),Z=(0,s.l)(m,"unstable_getServerProps"),S=(0,s.l)(m,"unstable_getServerSideProps"),A=new i.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/Campaigns",pathname:"/Campaigns",bundlePath:"",filename:""},components:{App:d(),Document:l()},userland:m});r()}catch(e){r(e)}})},24682:(e,a,t)=>{t.a(e,async(e,r)=>{try{t.d(a,{Z:()=>X});var i=t(20997),n=t(16689),s=t(75609),o=t(2296),l=t(3590),c=t(56667),d=t.n(c),m=t(48308),u=t(55223),p=t(12610),g=t.n(p),x=t(83974),h=t.n(x),f=t(26481),j=t.n(f),v=t(81961),y=t.n(v),b=t(80929),Z=t.n(b),S=t(46856),A=t.n(S),C=t(82400),w=t.n(C),I=t(9069),M=t.n(I),q=t(11277),N=t.n(q),D=t(4530),E=t.n(D),k=t(92921),P=t(32245),F=t.n(P),T=t(38561),$=t(151),L=t(41749),W=t(64436),z=t(85161),Y=t(94924),_=t(85639),O=t(57821),R=t(41423),B=t(14310),H=t(58582),G=t(6133),V=e([l,$,H]);[l,$,H]=V.then?(await V)():V;let J=(0,m.makeStyles)(e=>({root:{display:"flex",flexWrap:"wrap",backgroundColor:"#fff"},tabmsg:{backgroundColor:e.palette.campaigntab},textField:{marginRight:e.spacing(1),flex:1},extraAttr:{display:"flex",justifyContent:"center",alignItems:"center"},btnWrapper:{position:"relative"},buttonProgress:{color:u.green[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})),U=s.object().shape({name:s.string().min(2,"Too Short!").max(50,"Too Long!").required("Required")}),X=({open:e,onClose:a,campaignId:t,initialValues:r,onSave:s,resetPagination:c})=>{let m=J(),u=(0,n.useRef)(!0),{user:p}=(0,n.useContext)(H.V),{companyId:x}=p,f={name:"",message1:"",message2:"",message3:"",message4:"",message5:"",confirmationMessage1:"",confirmationMessage2:"",confirmationMessage3:"",confirmationMessage4:"",confirmationMessage5:"",status:"INATIVA",confirmation:!1,scheduledAt:"",whatsappId:"",contactListId:"",companyId:x},[v,b]=(0,n.useState)(f),[S,C]=(0,n.useState)([]),[I,q]=(0,n.useState)([]),[D,P]=(0,n.useState)(0),[V,X]=(0,n.useState)(null),[K,Q]=(0,n.useState)(!1),[ee,ea]=(0,n.useState)(!0),et=(0,n.useRef)(null);(0,n.useEffect)(()=>()=>{u.current=!1},[]),(0,n.useEffect)(()=>{u.current&&(r&&b(e=>({...e,...r})),T.Z.get("/contact-lists/list",{params:{companyId:x}}).then(({data:e})=>q(e)),T.Z.get("/whatsapp",{params:{companyId:x,session:0}}).then(({data:e})=>C(e)),t&&T.Z.get(`/campaigns/${t}`).then(({data:e})=>{b(a=>{let t=Object.assign({},a);return Object.entries(e).forEach(([e,a])=>{"scheduledAt"===e&&""!==a&&null!==a?t[e]=F()(a).format("YYYY-MM-DDTHH:mm"):t[e]=null===a?"":a}),t})}))},[t,e,r,x]),(0,n.useEffect)(()=>{let e=F()(),a=F()(v.scheduledAt),t=!Number.isNaN(a.diff(e))&&a.diff(e,"hour")>1,r="INATIVA"===v.status||"PROGRAMADA"===v.status&&t;ea(r)},[v.status,v.scheduledAt]);let er=()=>{a(),b(f)},ei=e=>{let a=d()(e.target.files);a&&X(a)},en=async e=>{try{let a={};if(Object.entries(e).forEach(([e,t])=>{"scheduledAt"===e&&""!==t&&null!==t?a[e]=F()(t).format("YYYY-MM-DD HH:mm:ss"):a[e]=""===t?null:t}),t){if(await T.Z.put(`/campaigns/${t}`,a),null!=V){let e=new FormData;e.append("file",V),await T.Z.post(`/campaigns/${t}/media-upload`,e)}er()}else{let{data:e}=await T.Z.post("/campaigns",a);if(null!=V){let a=new FormData;a.append("file",V),await T.Z.post(`/campaigns/${e.id}/media-upload`,a)}s&&s(e),er()}l.toast.success(k.a.t("campaigns.toasts.success"))}catch(e){console.log(e),(0,$.Z)(e)}},es=async()=>{V&&(X(null),et.current.value=null),v.mediaPath&&(await T.Z.delete(`/campaigns/${v.id}/media-upload`),b(e=>({...e,mediaPath:null,mediaName:null})),l.toast.success(k.a.t("campaigns.toasts.deleted")))},eo=e=>i.jsx(o.Field,{as:j(),id:e,name:e,fullWidth:!0,rows:5,label:k.a.t(`campaigns.dialog.form.${e}`),placeholder:k.a.t("campaigns.dialog.form.messagePlaceholder"),multiline:!0,variant:"outlined",helperText:"Utilize vari\xe1veis como {nome}, {numero}, {email} ou defina vari\xe1veis personalziadas.",disabled:!ee&&"CANCELADA"!==v.status}),el=e=>i.jsx(o.Field,{as:j(),id:e,name:e,fullWidth:!0,rows:5,label:k.a.t(`campaigns.dialog.form.${e}`),placeholder:k.a.t("campaigns.dialog.form.messagePlaceholder"),multiline:!0,variant:"outlined",disabled:!ee&&"CANCELADA"!==v.status}),ec=async()=>{try{await T.Z.post(`/campaigns/${v.id}/cancel`),l.toast.success(k.a.t("campaigns.toasts.cancel")),b(e=>({...e,status:"CANCELADA"})),c()}catch(e){l.toast.error(e.message)}},ed=async()=>{try{await T.Z.post(`/campaigns/${v.id}/restart`),l.toast.success(k.a.t("campaigns.toasts.restart")),b(e=>({...e,status:"EM_ANDAMENTO"})),c()}catch(e){l.toast.error(e.message)}};return(0,i.jsxs)("div",{className:m.root,children:[i.jsx(G.Z,{title:k.a.t("campaigns.confirmationModal.deleteTitle"),open:K,onClose:()=>Q(!1),onConfirm:es,children:k.a.t("campaigns.confirmationModal.deleteMessage")}),(0,i.jsxs)(y(),{open:e,onClose:er,fullWidth:!0,maxWidth:"md",scroll:"paper",children:[i.jsx(w(),{id:"form-dialog-title",children:ee?i.jsx(i.Fragment,{children:t?`${k.a.t("campaigns.dialog.update")}`:`${k.a.t("campaigns.dialog.new")}`}):i.jsx(i.Fragment,{children:`${k.a.t("campaigns.dialog.readonly")}`})}),i.jsx("div",{style:{display:"none"},children:i.jsx("input",{type:"file",ref:et,onChange:e=>ei(e)})}),i.jsx(o.Formik,{initialValues:v,enableReinitialize:!0,validationSchema:U,onSubmit:(e,a)=>{setTimeout(()=>{en(e),a.setSubmitting(!1)},400)},children:({values:e,errors:a,touched:r,isSubmitting:n})=>(0,i.jsxs)(o.Form,{children:[i.jsx(A(),{dividers:!0,children:(0,i.jsxs)(L.Z,{spacing:2,container:!0,children:[i.jsx(L.Z,{xs:12,md:9,item:!0,children:i.jsx(o.Field,{as:j(),label:k.a.t("campaigns.dialog.form.name"),name:"name",error:r.name&&!!a.name,helperText:r.name&&a.name,variant:"outlined",margin:"dense",fullWidth:!0,className:m.textField,disabled:!ee})}),i.jsx(L.Z,{xs:12,md:3,item:!0,children:(0,i.jsxs)(W.Z,{variant:"outlined",margin:"dense",fullWidth:!0,className:m.formControl,children:[i.jsx(z.Z,{id:"confirmation-selection-label",children:k.a.t("campaigns.dialog.form.confirmation")}),(0,i.jsxs)(o.Field,{as:Y.Z,label:k.a.t("campaigns.dialog.form.confirmation"),placeholder:k.a.t("campaigns.dialog.form.confirmation"),labelId:"confirmation-selection-label",id:"confirmation",name:"confirmation",error:r.confirmation&&!!a.confirmation,disabled:!ee,children:[i.jsx(_.Z,{value:!1,children:"Desabilitada"}),i.jsx(_.Z,{value:!0,children:"Habilitada"})]})]})}),i.jsx(L.Z,{xs:12,md:4,item:!0,children:(0,i.jsxs)(W.Z,{variant:"outlined",margin:"dense",fullWidth:!0,className:m.formControl,children:[i.jsx(z.Z,{id:"contactList-selection-label",children:k.a.t("campaigns.dialog.form.contactList")}),(0,i.jsxs)(o.Field,{as:Y.Z,label:k.a.t("campaigns.dialog.form.contactList"),placeholder:k.a.t("campaigns.dialog.form.contactList"),labelId:"contactList-selection-label",id:"contactListId",name:"contactListId",error:r.contactListId&&!!a.contactListId,disabled:!ee,children:[i.jsx(_.Z,{value:"",children:"Nenhuma"}),I&&I.map(e=>i.jsx(_.Z,{value:e.id,children:e.name},e.id))]})]})}),i.jsx(L.Z,{xs:12,md:4,item:!0,children:(0,i.jsxs)(W.Z,{variant:"outlined",margin:"dense",fullWidth:!0,className:m.formControl,children:[i.jsx(z.Z,{id:"whatsapp-selection-label",children:k.a.t("campaigns.dialog.form.whatsapp")}),(0,i.jsxs)(o.Field,{as:Y.Z,label:k.a.t("campaigns.dialog.form.whatsapp"),placeholder:k.a.t("campaigns.dialog.form.whatsapp"),labelId:"whatsapp-selection-label",id:"whatsappId",name:"whatsappId",error:r.whatsappId&&!!a.whatsappId,disabled:!ee,children:[i.jsx(_.Z,{value:"",children:"Nenhuma"}),S&&S.map(e=>i.jsx(_.Z,{value:e.id,children:e.name},e.id))]})]})}),i.jsx(L.Z,{xs:12,md:4,item:!0,children:i.jsx(o.Field,{as:j(),label:k.a.t("campaigns.dialog.form.scheduledAt"),name:"scheduledAt",error:r.scheduledAt&&!!a.scheduledAt,helperText:r.scheduledAt&&a.scheduledAt,variant:"outlined",margin:"dense",type:"datetime-local",InputLabelProps:{shrink:!0},fullWidth:!0,className:m.textField,disabled:!ee})}),(0,i.jsxs)(L.Z,{xs:12,item:!0,children:[(0,i.jsxs)(O.Z,{value:D,indicatorColor:"primary",textColor:"primary",className:m.tabmsg,onChange:(e,a)=>P(a),variant:"fullWidth",centered:!0,style:{borderRadius:2},children:[i.jsx(R.Z,{label:"Msg. 1",index:0}),i.jsx(R.Z,{label:"Msg. 2",index:1}),i.jsx(R.Z,{label:"Msg. 3",index:2}),i.jsx(R.Z,{label:"Msg. 4",index:3}),i.jsx(R.Z,{label:"Msg. 5",index:4})]}),(0,i.jsxs)(B.Z,{style:{paddingTop:20,border:"none"},children:[0===D&&i.jsx(i.Fragment,{children:e.confirmation?(0,i.jsxs)(L.Z,{spacing:2,container:!0,children:[i.jsx(L.Z,{xs:12,md:8,item:!0,children:i.jsx(i.Fragment,{children:eo("message1")})}),i.jsx(L.Z,{xs:12,md:4,item:!0,children:i.jsx(i.Fragment,{children:el("confirmationMessage1")})})]}):i.jsx(i.Fragment,{children:eo("message1")})}),1===D&&i.jsx(i.Fragment,{children:e.confirmation?(0,i.jsxs)(L.Z,{spacing:2,container:!0,children:[i.jsx(L.Z,{xs:12,md:8,item:!0,children:i.jsx(i.Fragment,{children:eo("message2")})}),i.jsx(L.Z,{xs:12,md:4,item:!0,children:i.jsx(i.Fragment,{children:el("confirmationMessage2")})})]}):i.jsx(i.Fragment,{children:eo("message2")})}),2===D&&i.jsx(i.Fragment,{children:e.confirmation?(0,i.jsxs)(L.Z,{spacing:2,container:!0,children:[i.jsx(L.Z,{xs:12,md:8,item:!0,children:i.jsx(i.Fragment,{children:eo("message3")})}),i.jsx(L.Z,{xs:12,md:4,item:!0,children:i.jsx(i.Fragment,{children:el("confirmationMessage3")})})]}):i.jsx(i.Fragment,{children:eo("message3")})}),3===D&&i.jsx(i.Fragment,{children:e.confirmation?(0,i.jsxs)(L.Z,{spacing:2,container:!0,children:[i.jsx(L.Z,{xs:12,md:8,item:!0,children:i.jsx(i.Fragment,{children:eo("message4")})}),i.jsx(L.Z,{xs:12,md:4,item:!0,children:i.jsx(i.Fragment,{children:el("confirmationMessage4")})})]}):i.jsx(i.Fragment,{children:eo("message4")})}),4===D&&i.jsx(i.Fragment,{children:e.confirmation?(0,i.jsxs)(L.Z,{spacing:2,container:!0,children:[i.jsx(L.Z,{xs:12,md:8,item:!0,children:i.jsx(i.Fragment,{children:eo("message5")})}),i.jsx(L.Z,{xs:12,md:4,item:!0,children:i.jsx(i.Fragment,{children:el("confirmationMessage5")})})]}):i.jsx(i.Fragment,{children:eo("message5")})})]})]}),(v.mediaPath||V)&&(0,i.jsxs)(L.Z,{xs:12,item:!0,children:[i.jsx(g(),{startIcon:i.jsx(N(),{}),children:null!=V?V.name:v.mediaName}),ee&&i.jsx(h(),{onClick:()=>Q(!0),color:"secondary",children:i.jsx(E(),{})})]})]})}),(0,i.jsxs)(Z(),{children:["CANCELADA"===v.status&&i.jsx(g(),{color:"primary",onClick:()=>ed(),variant:"outlined",children:k.a.t("campaigns.dialog.buttons.restart")}),"EM_ANDAMENTO"===v.status&&i.jsx(g(),{color:"primary",onClick:()=>ec(),variant:"outlined",children:k.a.t("campaigns.dialog.buttons.cancel")}),!V&&!v.mediaPath&&ee&&i.jsx(g(),{color:"primary",onClick:()=>et.current.click(),disabled:n,variant:"outlined",children:k.a.t("campaigns.dialog.buttons.attach")}),i.jsx(g(),{onClick:er,color:"secondary",disabled:n,variant:"outlined",children:k.a.t("campaigns.dialog.buttons.close")}),(ee||"CANCELADA"===v.status)&&(0,i.jsxs)(g(),{type:"submit",color:"primary",disabled:n,variant:"contained",className:m.btnWrapper,children:[t?`${k.a.t("campaigns.dialog.buttons.edit")}`:`${k.a.t("campaigns.dialog.buttons.add")}`,n&&i.jsx(M(),{size:24,className:m.buttonProgress})]})]})]})})]})]})};r()}catch(e){r(e)}})},29385:(e,a,t)=>{t.d(a,{Z:()=>m});var r=t(20997);t(16689);var i=t(42740),n=t.n(i),s=t(11236),o=t.n(s),l=t(44164),c=t.n(l);let d=(0,t(41120).Z)(e=>({customTableCell:{display:"flex",alignItems:"center",justifyContent:"center"}})),m=({avatar:e,columns:a})=>{let t=d();return r.jsx(r.Fragment,{children:(0,r.jsxs)(o(),{children:[e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx(n(),{style:{paddingRight:0},children:r.jsx(c(),{animation:"wave",variant:"circle",width:40,height:40})}),r.jsx(n(),{children:r.jsx(c(),{animation:"wave",height:30,width:80})})]}),Array.from({length:a},(e,a)=>r.jsx(n(),{align:"center",children:r.jsx("div",{className:t.customTableCell,children:r.jsx(c(),{align:"center",animation:"wave",height:30,width:80})})},a))]})})}},58582:(e,a,t)=>{t.a(e,async(e,r)=>{try{t.d(a,{V:()=>o}),t(20997);var i=t(16689),n=t(85425),s=e([n]);n=(s.then?(await s)():s)[0];let o=(0,i.createContext)();r()}catch(e){r(e)}})},85425:(e,a,t)=>{t.a(e,async(e,r)=>{try{t.d(a,{Z:()=>j});var i=t(16689),n=t(14661),s=t(98210),o=t.n(s),l=t(35599),c=t.n(l),d=t(3590),m=t(92921),u=t(38561),p=t(151),g=t(7405),x=t(32245),h=t.n(x),f=e([d,p,g]);[d,p,g]=f.then?(await f)():f;let j=()=>{let e=(0,n.useNavigate)(),[a,t]=(0,i.useState)(!1),[r,s]=(0,i.useState)(!0),[l,x]=(0,i.useState)({});u.Z.interceptors.request.use(e=>{let a=localStorage.getItem("token");return a&&(e.headers.Authorization=`Bearer ${JSON.parse(a)}`,t(!0)),e},e=>{Promise.reject(e)}),u.Z.interceptors.response.use(e=>e,async e=>{let a=e.config;if(e?.response?.status===403&&!a._retry){a._retry=!0;let{data:e}=await u.Z.post("/auth/refresh_token");return e&&(localStorage.setItem("token",JSON.stringify(e.token)),u.Z.defaults.headers.Authorization=`Bearer ${e.token}`),(0,u.Z)(a)}return e?.response?.status===401&&(localStorage.removeItem("token"),localStorage.removeItem("companyId"),u.Z.defaults.headers.Authorization=void 0,t(!1)),Promise.reject(e)}),(0,i.useEffect)(()=>{let e=localStorage.getItem("token");(async()=>{if(e)try{let{data:e}=await u.Z.post("/auth/refresh_token");u.Z.defaults.headers.Authorization=`Bearer ${e.token}`,t(!0),x(e.user)}catch(e){(0,p.Z)(e)}s(!1)})()},[]),(0,i.useEffect)(()=>{let e=localStorage.getItem("companyId");if(e){let a=(0,g.C)({companyId:e});return a.on(`company-${e}-user`,e=>{"update"===e.action&&e.user.id===l.id&&x(e.user)}),()=>{a.disconnect()}}},[l]);let f=async a=>{s(!0);try{let{data:l}=await u.Z.post("/auth/login",a),{user:{companyId:g,id:f,company:j}}=l;if(o()(j,"settings")&&c()(j.settings)){let e=j.settings.find(e=>"campaignsEnabled"===e.key);e&&"true"===e.value&&localStorage.setItem("cshow",null)}h().locale("pt-br");let v=l.user.company.dueDate;h()(h()()).format("DD/MM/yyyy");let y=h()(v).format("DD/MM/yyyy");var r=h()(v).diff(h()(h()()).format()),i=h()(h()().format()).isBefore(v),n=h().duration(r).asDays();!0===i?(localStorage.setItem("token",JSON.stringify(l.token)),localStorage.setItem("companyId",g),localStorage.setItem("userId",f),localStorage.setItem("companyDueDate",y),u.Z.defaults.headers.Authorization=`Bearer ${l.token}`,x(l.user),t(!0),d.toast.success(m.a.t("auth.toasts.success")),5>Math.round(n)&&d.toast.warn(`Sua assinatura vence em ${Math.round(n)} ${1===Math.round(n)?"dia":"dias"} `),e.push("/tickets")):(0,p.Z)(`Opss! Sua assinatura venceu ${y}.
Entre em contato com o Suporte para mais informa\xe7\xf5es! `),s(!1)}catch(e){(0,p.Z)(e),s(!1)}},j=async()=>{s(!0);try{await u.Z.delete("/auth/logout"),t(!1),x({}),localStorage.removeItem("token"),localStorage.removeItem("companyId"),localStorage.removeItem("userId"),localStorage.removeItem("cshow"),u.Z.defaults.headers.Authorization=void 0,s(!1),e.push("/login")}catch(e){(0,p.Z)(e),s(!1)}},v=async()=>{try{let{data:e}=await u.Z.get("/auth/me");return e}catch(e){(0,p.Z)(e)}};return{isAuth:a,user:l,loading:r,handleLogin:f,handleLogout:j,getCurrentUserInfo:v}};r()}catch(e){r(e)}})},74846:(e,a,t)=>{t.d(a,{Y:()=>n});var r=t(32245),i=t.n(r);function n(){return{dateToClient:function(e){return i()(e).isValid()?i()(e).format("DD/MM/YYYY"):e},datetimeToClient:function(e){return i()(e).isValid()?i()(e).format("DD/MM/YYYY HH:mm"):e},dateToDatabase:function(e){return i()(e,"DD/MM/YYYY").isValid()?i()(e).format("YYYY-MM-DD HH:mm:ss"):e}}}},67225:(e,a,t)=>{t.a(e,async(e,r)=>{try{t.r(a),t.d(a,{default:()=>ei});var i=t(20997),n=t(16689),s=t(3590),o=t(14661),l=t(48308),c=t(40640),d=t.n(c),m=t(12610),u=t.n(m),p=t(4880),g=t.n(p),x=t(31555),h=t.n(x),f=t(42740),j=t.n(f),v=t(56956),y=t.n(v),b=t(11236),Z=t.n(b),S=t(83974),A=t.n(S),C=t(94202),w=t.n(C),I=t(26481),M=t.n(I),q=t(32944),N=t.n(q),D=t(4530),E=t.n(D),k=t(93365),P=t.n(k),F=t(7780),T=t.n(F);t(95064);var $=t(90609),L=t.n($),W=t(39658),z=t.n(W),Y=t(96153),_=t(66276),O=t(2926),R=t(38561),B=t(92921),H=t(29385),G=t(24682),V=t(6133),J=t(151),U=t(41749),X=t(35599),K=t.n(X),Q=t(74846),ee=t(7405),ea=e([s,G,J,ee]);[s,G,J,ee]=ea.then?(await ea)():ea;let et=(e,a)=>{if("LOAD_CAMPAIGNS"===a.type){let t=a.payload,r=[];return K()(t)&&t.forEach(a=>{let t=e.findIndex(e=>e.id===a.id);-1!==t?e[t]=a:r.push(a)}),[...e,...r]}if("UPDATE_CAMPAIGNS"===a.type){let t=a.payload,r=e.findIndex(e=>e.id===t.id);return -1!==r?(e[r]=t,[...e]):[t,...e]}if("DELETE_CAMPAIGN"===a.type){let t=a.payload,r=e.findIndex(e=>e.id===t);return -1!==r&&e.splice(r,1),[...e]}if("RESET"===a.type)return[]},er=(0,l.makeStyles)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles}})),ei=()=>{let e=er(),a=(0,o.useNavigate)(),[t,r]=(0,n.useState)(!1),[l,c]=(0,n.useState)(1),[m,p]=(0,n.useState)(!1),[x,f]=(0,n.useState)(null),[v,b]=(0,n.useState)(null),[S,C]=(0,n.useState)(!1),[I,q]=(0,n.useState)(!1),[D,k]=(0,n.useState)(""),[F,$]=(0,n.useReducer)(et,[]),{datetimeToClient:W}=(0,Q.Y)();(0,n.useEffect)(()=>{$({type:"RESET"}),c(1)},[D]),(0,n.useEffect)(()=>{r(!0);let e=setTimeout(()=>{X()},500);return()=>clearTimeout(e)},[D,l]),(0,n.useEffect)(()=>{let e=localStorage.getItem("companyId"),a=(0,ee.C)({companyId:e});return a.on(`company-${e}-campaign`,e=>{("update"===e.action||"create"===e.action)&&$({type:"UPDATE_CAMPAIGNS",payload:e.record}),"delete"===e.action&&$({type:"DELETE_CAMPAIGN",payload:+e.id})}),()=>{a.disconnect()}},[]);let X=async()=>{try{let{data:e}=await R.Z.get("/campaigns/",{params:{searchParam:D,pageNumber:l}});$({type:"LOAD_CAMPAIGNS",payload:e.records}),p(e.hasMore),r(!1)}catch(e){(0,J.Z)(e)}},K=e=>{f(e),C(!0)},ea=async e=>{try{await R.Z.delete(`/campaigns/${e}`),s.toast.success(B.a.t("campaigns.toasts.deleted"))}catch(e){(0,J.Z)(e)}b(null),k(""),c(1)},ei=()=>{c(e=>e+1)},en=e=>{switch(e){case"INATIVA":return"Inativa";case"PROGRAMADA":return"Programada";case"EM_ANDAMENTO":return"Em Andamento";case"CANCELADA":return"Cancelada";case"FINALIZADA":return"Finalizada";default:return e}},es=async e=>{try{await R.Z.post(`/campaigns/${e.id}/cancel`),s.toast.success(B.a.t("campaigns.toasts.cancel")),c(1),X()}catch(e){s.toast.error(e.message)}},eo=async e=>{try{await R.Z.post(`/campaigns/${e.id}/restart`),s.toast.success(B.a.t("campaigns.toasts.restart")),c(1),X()}catch(e){s.toast.error(e.message)}};return(0,i.jsxs)(Y.Z,{children:[i.jsx(V.Z,{title:v&&`${B.a.t("campaigns.confirmationModal.deleteTitle")} ${v.name}?`,open:I,onClose:q,onConfirm:()=>ea(v.id),children:B.a.t("campaigns.confirmationModal.deleteMessage")}),i.jsx(G.Z,{resetPagination:()=>{c(1),X()},open:S,onClose:()=>{f(null),C(!1)},"aria-labelledby":"form-dialog-title",campaignId:x&&x.id}),i.jsx(_.Z,{children:(0,i.jsxs)(U.Z,{style:{width:"99.6%"},container:!0,children:[i.jsx(U.Z,{xs:12,sm:8,item:!0,children:i.jsx(O.Z,{children:B.a.t("campaigns.title")})}),i.jsx(U.Z,{xs:12,sm:4,item:!0,children:(0,i.jsxs)(U.Z,{spacing:2,container:!0,children:[i.jsx(U.Z,{xs:6,sm:6,item:!0,children:i.jsx(M(),{fullWidth:!0,placeholder:B.a.t("campaigns.searchPlaceholder"),type:"search",value:D,onChange:e=>{k(e.target.value.toLowerCase())},InputProps:{startAdornment:i.jsx(N(),{position:"start",children:i.jsx(w(),{style:{color:"gray"}})})}})}),i.jsx(U.Z,{xs:6,sm:6,item:!0,children:i.jsx(u(),{fullWidth:!0,variant:"contained",onClick:()=>{f(null),C(!0)},color:"primary",children:B.a.t("campaigns.buttons.add")})})]})})]})}),i.jsx(d(),{className:e.mainPaper,variant:"outlined",onScroll:e=>{if(!m||t)return;let{scrollTop:a,scrollHeight:r,clientHeight:i}=e.currentTarget;r-(a+100)<i&&ei()},children:(0,i.jsxs)(g(),{size:"small",children:[i.jsx(y(),{children:(0,i.jsxs)(Z(),{children:[i.jsx(j(),{align:"center",children:B.a.t("campaigns.table.name")}),i.jsx(j(),{align:"center",children:B.a.t("campaigns.table.status")}),i.jsx(j(),{align:"center",children:B.a.t("campaigns.table.contactList")}),i.jsx(j(),{align:"center",children:B.a.t("campaigns.table.whatsapp")}),i.jsx(j(),{align:"center",children:B.a.t("campaigns.table.scheduledAt")}),i.jsx(j(),{align:"center",children:B.a.t("campaigns.table.completedAt")}),i.jsx(j(),{align:"center",children:B.a.t("campaigns.table.confirmation")}),i.jsx(j(),{align:"center",children:B.a.t("campaigns.table.actions")})]})}),i.jsx(h(),{children:(0,i.jsxs)(i.Fragment,{children:[F.map(e=>(0,i.jsxs)(Z(),{children:[i.jsx(j(),{align:"center",children:e.name}),i.jsx(j(),{align:"center",children:en(e.status)}),i.jsx(j(),{align:"center",children:e.contactListId?e.contactList.name:"N\xe3o definida"}),i.jsx(j(),{align:"center",children:e.whatsappId?e.whatsapp.name:"N\xe3o definido"}),i.jsx(j(),{align:"center",children:e.scheduledAt?W(e.scheduledAt):"Sem agendamento"}),i.jsx(j(),{align:"center",children:e.completedAt?W(e.completedAt):"N\xe3o conclu\xedda"}),i.jsx(j(),{align:"center",children:e.confirmation?"Habilitada":"Desabilitada"}),(0,i.jsxs)(j(),{align:"center",children:["EM_ANDAMENTO"===e.status&&i.jsx(A(),{onClick:()=>es(e),title:"Parar Campanha",size:"small",children:i.jsx(z(),{})}),"CANCELADA"===e.status&&i.jsx(A(),{onClick:()=>eo(e),title:"Parar Campanha",size:"small",children:i.jsx(L(),{})}),i.jsx(A(),{onClick:()=>a.push(`/campaign/${e.id}/report`),size:"small",children:i.jsx(T(),{})}),i.jsx(A(),{size:"small",onClick:()=>K(e),children:i.jsx(P(),{})}),i.jsx(A(),{size:"small",onClick:a=>{q(!0),b(e)},children:i.jsx(E(),{})})]})]},e.id)),t&&i.jsx(H.Z,{columns:8})]})})]})})]})};r()}catch(e){r(e)}})},12610:e=>{e.exports=require("@material-ui/core/Button")},9069:e=>{e.exports=require("@material-ui/core/CircularProgress")},32705:e=>{e.exports=require("@material-ui/core/Container")},81961:e=>{e.exports=require("@material-ui/core/Dialog")},80929:e=>{e.exports=require("@material-ui/core/DialogActions")},46856:e=>{e.exports=require("@material-ui/core/DialogContent")},82400:e=>{e.exports=require("@material-ui/core/DialogTitle")},83974:e=>{e.exports=require("@material-ui/core/IconButton")},32944:e=>{e.exports=require("@material-ui/core/InputAdornment")},40640:e=>{e.exports=require("@material-ui/core/Paper")},4880:e=>{e.exports=require("@material-ui/core/Table")},31555:e=>{e.exports=require("@material-ui/core/TableBody")},42740:e=>{e.exports=require("@material-ui/core/TableCell")},56956:e=>{e.exports=require("@material-ui/core/TableHead")},11236:e=>{e.exports=require("@material-ui/core/TableRow")},26481:e=>{e.exports=require("@material-ui/core/TextField")},54104:e=>{e.exports=require("@material-ui/core/Typography")},55223:e=>{e.exports=require("@material-ui/core/colors")},48308:e=>{e.exports=require("@material-ui/core/styles")},11277:e=>{e.exports=require("@material-ui/icons/AttachFile")},4530:e=>{e.exports=require("@material-ui/icons/DeleteOutline")},7780:e=>{e.exports=require("@material-ui/icons/Description")},93365:e=>{e.exports=require("@material-ui/icons/Edit")},39658:e=>{e.exports=require("@material-ui/icons/PauseCircleOutline")},90609:e=>{e.exports=require("@material-ui/icons/PlayCircleOutline")},94202:e=>{e.exports=require("@material-ui/icons/Search")},95064:e=>{e.exports=require("@material-ui/icons/TimerOff")},44164:e=>{e.exports=require("@material-ui/lab/Skeleton")},43349:e=>{e.exports=require("@material-ui/styles")},95027:e=>{e.exports=require("@material-ui/system")},23874:e=>{e.exports=require("@material-ui/utils")},52167:e=>{e.exports=require("axios")},68103:e=>{e.exports=require("clsx")},2296:e=>{e.exports=require("formik")},18805:e=>{e.exports=require("i18next")},86071:e=>{e.exports=require("i18next-browser-languagedetector")},98210:e=>{e.exports=require("lodash/has")},56667:e=>{e.exports=require("lodash/head")},35599:e=>{e.exports=require("lodash/isArray")},75795:e=>{e.exports=require("lodash/isObject")},97026:e=>{e.exports=require("lodash/isString")},32245:e=>{e.exports=require("moment")},62785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},580:e=>{e.exports=require("prop-types")},16689:e=>{e.exports=require("react")},66405:e=>{e.exports=require("react-dom")},14661:e=>{e.exports=require("react-router-dom")},84466:e=>{e.exports=require("react-transition-group")},20997:e=>{e.exports=require("react/jsx-runtime")},75609:e=>{e.exports=require("yup")},3590:e=>{e.exports=import("react-toastify")},14612:e=>{e.exports=import("socket.io-client")},71017:e=>{e.exports=require("path")}};var a=require("../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[5388,9908,895,9154,4924,273,5800,4405],()=>t(37837));module.exports=r})();