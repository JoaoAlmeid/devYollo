"use strict";(()=>{var e={};e.id=9337,e.ids=[9337,660],e.modules={30553:(e,t,r)=>{r.d(t,{Z:()=>p});var a=r(87462),o=r(91),i=r(16689);r(580);var l=r(68103),s=r.n(l);r(23874);var n=r(22601),c=r(52543),u=r(22318),d=r(93871),m=i.forwardRef(function(e,t){e.checked;var r=e.classes,l=e.className,c=e.control,m=e.disabled,p=(e.inputRef,e.label),h=e.labelPlacement,x=void 0===h?"end":h,g=(e.name,e.onChange,e.value,(0,o.Z)(e,["checked","classes","className","control","disabled","inputRef","label","labelPlacement","name","onChange","value"])),f=(0,n.Z)(),y=m;void 0===y&&void 0!==c.props.disabled&&(y=c.props.disabled),void 0===y&&f&&(y=f.disabled);var S={disabled:y};return["checked","name","onChange","value","inputRef"].forEach(function(t){void 0===c.props[t]&&void 0!==e[t]&&(S[t]=e[t])}),i.createElement("label",(0,a.Z)({className:s()(r.root,l,"end"!==x&&r["labelPlacement".concat((0,d.Z)(x))],y&&r.disabled),ref:t},g),i.cloneElement(c,S),i.createElement(u.Z,{component:"span",className:s()(r.label,y&&r.disabled)},p))});let p=(0,c.Z)(function(e){return{root:{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,"&$disabled":{cursor:"default"}},labelPlacementStart:{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},labelPlacementTop:{flexDirection:"column-reverse",marginLeft:16},labelPlacementBottom:{flexDirection:"column",marginLeft:16},disabled:{},label:{"&$disabled":{color:e.palette.text.disabled}}}},{name:"MuiFormControlLabel"})(m)},15736:(e,t,r)=>{r.d(t,{Y:()=>i,Z:()=>l});var a=r(16689),o=a.createContext();function i(){return a.useContext(o)}let l=o},22601:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(16689),o=r(15736);function i(){return a.useContext(o.Z)}},62087:(e,t,r)=>{r.d(t,{Z:()=>d});var a=r(87462),o=r(91),i=r(16689);r(580);var l=r(68103),s=r.n(l);r(23874);var n=r(52543),c=r(93871),u=i.forwardRef(function(e,t){var r=e.children,l=e.classes,n=e.className,u=e.color,d=void 0===u?"inherit":u,m=e.component,p=e.fontSize,h=void 0===p?"medium":p,x=e.htmlColor,g=e.titleAccess,f=e.viewBox,y=(0,o.Z)(e,["children","classes","className","color","component","fontSize","htmlColor","titleAccess","viewBox"]);return i.createElement(void 0===m?"svg":m,(0,a.Z)({className:s()(l.root,n,"inherit"!==d&&l["color".concat((0,c.Z)(d))],"default"!==h&&"medium"!==h&&l["fontSize".concat((0,c.Z)(h))]),focusable:"false",viewBox:void 0===f?"0 0 24 24":f,color:x,"aria-hidden":!g||void 0,role:g?"img":void 0,ref:t},y),r,g?i.createElement("title",null,g):null)});u.muiName="SvgIcon";let d=(0,n.Z)(function(e){return{root:{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,fontSize:e.typography.pxToRem(24),transition:e.transitions.create("fill",{duration:e.transitions.duration.shorter})},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},colorAction:{color:e.palette.action.active},colorError:{color:e.palette.error.main},colorDisabled:{color:e.palette.action.disabled},fontSizeInherit:{fontSize:"inherit"},fontSizeSmall:{fontSize:e.typography.pxToRem(20)},fontSizeLarge:{fontSize:e.typography.pxToRem(35)}}},{name:"MuiSvgIcon"})(u)},63786:(e,t,r)=>{r.d(t,{Z:()=>s});var a=r(87462),o=r(16689),i=r.n(o),l=r(62087);function s(e,t){var r=function(t,r){return i().createElement(l.Z,(0,a.Z)({ref:r},t),e)};return r.muiName=l.Z.muiName,i().memo(i().forwardRef(r))}},67236:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>f,default:()=>p,getServerSideProps:()=>g,getStaticPaths:()=>x,getStaticProps:()=>h,reportWebVitals:()=>y,routeModule:()=>q,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>Z,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>b,unstable_getStaticProps:()=>S});var o=r(87093),i=r(35244),l=r(1323),s=r(55388),n=r.n(s),c=r(16769),u=r.n(c),d=r(31342),m=e([d]);d=(m.then?(await m)():m)[0];let p=(0,l.l)(d,"default"),h=(0,l.l)(d,"getStaticProps"),x=(0,l.l)(d,"getStaticPaths"),g=(0,l.l)(d,"getServerSideProps"),f=(0,l.l)(d,"config"),y=(0,l.l)(d,"reportWebVitals"),S=(0,l.l)(d,"unstable_getStaticProps"),b=(0,l.l)(d,"unstable_getStaticPaths"),v=(0,l.l)(d,"unstable_getStaticParams"),j=(0,l.l)(d,"unstable_getServerProps"),Z=(0,l.l)(d,"unstable_getServerSideProps"),q=new o.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/Tags",pathname:"/Tags",bundlePath:"",filename:""},components:{App:u(),Document:n()},userland:d});a()}catch(e){a(e)}})},79961:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{Z:()=>$});var o=r(20997),i=r(16689),l=r(75609),s=r(2296),n=r(3590),c=r(48308),u=r(55223),d=r(12610),m=r.n(d),p=r(26481),h=r.n(p),x=r(81961),g=r.n(x),f=r(80929),y=r.n(f),S=r(46856),b=r.n(S),v=r(82400),j=r.n(v),Z=r(9069),q=r.n(Z),k=r(15085),C=r(62684),P=r(92921),I=r(38561),w=r(151),E=r(58582),T=r(7397),A=r(17812),M=r(30553);r(84614),r(48250),r(68190);var D=r(8350),z=r.n(D),N=e([n,w,E]);[n,w,E]=N.then?(await N)():N;let R=(0,c.makeStyles)(e=>({root:{display:"flex",flexWrap:"wrap"},multFieldLine:{display:"flex","& > *:not(:last-child)":{marginRight:e.spacing(1)}},btnWrapper:{position:"relative"},buttonProgress:{color:u.green[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},formControl:{margin:e.spacing(1),minWidth:120},colorAdorment:{width:20,height:20}})),_=l.object().shape({name:l.string().min(3,"Mensagem muito curta").required("Obrigat\xf3rio")}),$=({open:e,onClose:t,tagId:r,reload:a})=>{let l=R(),{user:c}=(0,i.useContext)(E.V),[u,d]=(0,i.useState)(!1),p={name:"",color:"",kanban:0},[x,f]=(0,i.useState)(p),[S,v]=(0,i.useState)(0);(0,i.useEffect)(()=>{try{(async()=>{if(!r)return;let{data:e}=await I.Z.get(`/tags/${r}`);v(e.kanban),f(t=>({...t,...e}))})()}catch(e){(0,w.Z)(e)}},[r,e]);let Z=()=>{f(p),d(!1),t()},D=e=>{v(e.target.checked?1:0)},N=async e=>{let t={...e,userId:c.id,kanban:S};try{r?await I.Z.put(`/tags/${r}`,t):await I.Z.post("/tags",t),n.toast.success(P.a.t("tagModal.success")),"function"==typeof a&&a()}catch(e){(0,w.Z)(e)}Z()};return o.jsx("div",{className:l.root,children:(0,o.jsxs)(g(),{open:e,onClose:Z,maxWidth:"xs",fullWidth:!0,scroll:"paper",children:[o.jsx(j(),{id:"form-dialog-title",children:r?`${P.a.t("tagModal.title.edit")}`:`${P.a.t("tagModal.title.add")}`}),o.jsx(s.Formik,{initialValues:x,enableReinitialize:!0,validationSchema:_,onSubmit:(e,t)=>{setTimeout(()=>{N(e),t.setSubmitting(!1)},400)},children:({touched:e,errors:t,isSubmitting:a,values:i})=>(0,o.jsxs)(s.Form,{children:[(0,o.jsxs)(b(),{dividers:!0,children:[o.jsx("div",{className:l.multFieldLine,children:o.jsx(s.Field,{as:h(),label:P.a.t("tagModal.form.name"),name:"name",error:e.name&&!!t.name,helperText:e.name&&t.name,variant:"outlined",margin:"dense",onChange:e=>f(t=>({...t,name:e.target.value})),fullWidth:!0})}),o.jsx("br",{}),o.jsx("div",{className:l.multFieldLine,children:o.jsx(s.Field,{as:h(),fullWidth:!0,label:P.a.t("tagModal.form.color"),name:"color",id:"color",error:e.color&&!!t.color,helperText:e.color&&t.color,InputProps:{startAdornment:o.jsx(T.Z,{position:"start",children:o.jsx("div",{style:{backgroundColor:i.color},className:l.colorAdorment})}),endAdornment:o.jsx(A.Z,{size:"small",color:"default",onClick:()=>d(!u),children:o.jsx(k.Z,{})})},variant:"outlined",margin:"dense"})}),("admin"===c.profile||"supervisor"===c.profile)&&(0,o.jsxs)(o.Fragment,{children:[o.jsx("div",{className:l.multFieldLine,children:o.jsx(M.Z,{control:o.jsx(z(),{checked:1===S,onChange:D,value:S,color:"primary"}),label:"Kanban",labelPlacement:"start"})}),o.jsx("br",{})]}),u&&o.jsx("div",{children:o.jsx(C.ColorBox,{disableAlpha:!0,hslGradient:!1,style:{margin:"20px auto 0"},value:x.color,onChange:e=>{f(t=>({...t,color:`#${e.hex}`}))}})})]}),(0,o.jsxs)(y(),{children:[o.jsx(m(),{onClick:Z,color:"secondary",disabled:a,variant:"outlined",children:P.a.t("tagModal.buttons.cancel")}),(0,o.jsxs)(m(),{type:"submit",color:"primary",disabled:a,variant:"contained",className:l.btnWrapper,children:[r?`${P.a.t("tagModal.buttons.okEdit")}`:`${P.a.t("tagModal.buttons.okAdd")}`,a&&o.jsx(q(),{size:24,className:l.buttonProgress})]})]})]})})]})})};a()}catch(e){a(e)}})},58582:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{V:()=>s}),r(20997);var o=r(16689),i=r(85425),l=e([i]);i=(l.then?(await l)():l)[0];let s=(0,o.createContext)();a()}catch(e){a(e)}})},85425:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.d(t,{Z:()=>y});var o=r(16689),i=r(14661),l=r(98210),s=r.n(l),n=r(35599),c=r.n(n),u=r(3590),d=r(92921),m=r(38561),p=r(151),h=r(7405),x=r(32245),g=r.n(x),f=e([u,p,h]);[u,p,h]=f.then?(await f)():f;let y=()=>{let e=(0,i.useNavigate)(),[t,r]=(0,o.useState)(!1),[a,l]=(0,o.useState)(!0),[n,x]=(0,o.useState)({});m.Z.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${JSON.parse(t)}`,r(!0)),e},e=>{Promise.reject(e)}),m.Z.interceptors.response.use(e=>e,async e=>{let t=e.config;if(e?.response?.status===403&&!t._retry){t._retry=!0;let{data:e}=await m.Z.post("/auth/refresh_token");return e&&(localStorage.setItem("token",JSON.stringify(e.token)),m.Z.defaults.headers.Authorization=`Bearer ${e.token}`),(0,m.Z)(t)}return e?.response?.status===401&&(localStorage.removeItem("token"),localStorage.removeItem("companyId"),m.Z.defaults.headers.Authorization=void 0,r(!1)),Promise.reject(e)}),(0,o.useEffect)(()=>{let e=localStorage.getItem("token");(async()=>{if(e)try{let{data:e}=await m.Z.post("/auth/refresh_token");m.Z.defaults.headers.Authorization=`Bearer ${e.token}`,r(!0),x(e.user)}catch(e){(0,p.Z)(e)}l(!1)})()},[]),(0,o.useEffect)(()=>{let e=localStorage.getItem("companyId");if(e){let t=(0,h.C)({companyId:e});return t.on(`company-${e}-user`,e=>{"update"===e.action&&e.user.id===n.id&&x(e.user)}),()=>{t.disconnect()}}},[n]);let f=async t=>{l(!0);try{let{data:n}=await m.Z.post("/auth/login",t),{user:{companyId:h,id:f,company:y}}=n;if(s()(y,"settings")&&c()(y.settings)){let e=y.settings.find(e=>"campaignsEnabled"===e.key);e&&"true"===e.value&&localStorage.setItem("cshow",null)}g().locale("pt-br");let S=n.user.company.dueDate;g()(g()()).format("DD/MM/yyyy");let b=g()(S).format("DD/MM/yyyy");var a=g()(S).diff(g()(g()()).format()),o=g()(g()().format()).isBefore(S),i=g().duration(a).asDays();!0===o?(localStorage.setItem("token",JSON.stringify(n.token)),localStorage.setItem("companyId",h),localStorage.setItem("userId",f),localStorage.setItem("companyDueDate",b),m.Z.defaults.headers.Authorization=`Bearer ${n.token}`,x(n.user),r(!0),u.toast.success(d.a.t("auth.toasts.success")),5>Math.round(i)&&u.toast.warn(`Sua assinatura vence em ${Math.round(i)} ${1===Math.round(i)?"dia":"dias"} `),e.push("/tickets")):(0,p.Z)(`Opss! Sua assinatura venceu ${b}.
Entre em contato com o Suporte para mais informa\xe7\xf5es! `),l(!1)}catch(e){(0,p.Z)(e),l(!1)}},y=async()=>{l(!0);try{await m.Z.delete("/auth/logout"),r(!1),x({}),localStorage.removeItem("token"),localStorage.removeItem("companyId"),localStorage.removeItem("userId"),localStorage.removeItem("cshow"),m.Z.defaults.headers.Authorization=void 0,l(!1),e.push("/login")}catch(e){(0,p.Z)(e),l(!1)}},S=async()=>{try{let{data:e}=await m.Z.get("/auth/me");return e}catch(e){(0,p.Z)(e)}};return{isAuth:t,user:n,loading:a,handleLogin:f,handleLogout:y,getCurrentUserInfo:S}};a()}catch(e){a(e)}})},31342:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>Y});var o=r(20997),i=r(16689),l=r(3590),s=r(48308),n=r(40640),c=r.n(n),u=r(12610),d=r.n(u),m=r(4880),p=r.n(m),h=r(31555),x=r.n(h),g=r(42740),f=r.n(g),y=r(56956),S=r.n(y),b=r(11236),v=r.n(b),j=r(83974),Z=r.n(j),q=r(94202),k=r.n(q),C=r(26481),P=r.n(C),I=r(32944),w=r.n(I),E=r(4530),T=r.n(E),A=r(93365),M=r.n(A),D=r(96153),z=r(66276),N=r(37432),R=r(2926),_=r(38561),$=r(92921),L=r(29385),B=r(79961),F=r(6133),W=r(151),O=r(16204),G=r(7405),V=r(58582),H=e([l,B,W,G,V]);[l,B,W,G,V]=H.then?(await H)():H;let J=(e,t)=>{if("LOAD_TAGS"===t.type){let r=t.payload,a=[];return r.forEach(t=>{let r=e.findIndex(e=>e.id===t.id);-1!==r?e[r]=t:a.push(t)}),[...e,...a]}if("UPDATE_TAGS"===t.type){let r=t.payload,a=e.findIndex(e=>e.id===r.id);return -1!==a?(e[a]=r,[...e]):[r,...e]}if("DELETE_TAG"===t.type){let r=t.payload,a=e.findIndex(e=>e.id===r);return -1!==a&&e.splice(a,1),[...e]}if("RESET"===t.type)return[]},U=(0,s.makeStyles)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles}})),Y=()=>{let e=U(),{user:t}=(0,i.useContext)(V.V),[r,a]=(0,i.useState)(!1),[s,n]=(0,i.useState)(1),[u,m]=(0,i.useState)(!1),[h,g]=(0,i.useState)(null),[y,b]=(0,i.useState)(null),[j,q]=(0,i.useState)(!1),[C,I]=(0,i.useState)(""),[E,A]=(0,i.useReducer)(J,[]),[H,Y]=(0,i.useState)(!1),K=(0,i.useCallback)(async()=>{try{let{data:e}=await _.Z.get("/tags/",{params:{searchParam:C,pageNumber:s}});A({type:"LOAD_TAGS",payload:e.tags}),m(e.hasMore),a(!1)}catch(e){(0,W.Z)(e)}},[C,s]);(0,i.useEffect)(()=>{A({type:"RESET"}),n(1)},[C]),(0,i.useEffect)(()=>{a(!0);let e=setTimeout(()=>{K()},500);return()=>clearTimeout(e)},[C,s,K]),(0,i.useEffect)(()=>{let e=(0,G.C)({companyId:t.companyId});return e.on("user",e=>{("update"===e.action||"create"===e.action)&&A({type:"UPDATE_TAGS",payload:e.tags}),"delete"===e.action&&A({type:"DELETE_USER",payload:+e.tagId})}),()=>{e.disconnect()}},[t]);let X=e=>{g(e),Y(!0)},Q=async e=>{try{await _.Z.delete(`/tags/${e}`),l.toast.success($.a.t("tags.toasts.deleted"))}catch(e){(0,W.Z)(e)}b(null),I(""),n(1),A({type:"RESET"}),n(1),await K()},ee=()=>{n(e=>e+1)};return(0,o.jsxs)(D.Z,{children:[o.jsx(F.Z,{title:y&&`${$.a.t("tags.confirmationModal.deleteTitle")}`,open:j,onClose:q,onConfirm:()=>Q(y.id),children:$.a.t("tags.confirmationModal.deleteMessage")}),o.jsx(B.Z,{open:H,onClose:()=>{g(null),Y(!1)},reload:K,"aria-labelledby":"form-dialog-title",tagId:h&&h.id}),(0,o.jsxs)(z.Z,{children:[o.jsx(R.Z,{children:$.a.t("tags.title")}),(0,o.jsxs)(N.Z,{children:[o.jsx(P(),{placeholder:$.a.t("contacts.searchPlaceholder"),type:"search",value:C,onChange:e=>{I(e.target.value.toLowerCase())},InputProps:{startAdornment:o.jsx(w(),{position:"start",children:o.jsx(k(),{style:{color:"gray"}})})}}),o.jsx(d(),{variant:"contained",color:"primary",onClick:()=>{g(null),Y(!0)},children:$.a.t("tags.buttons.add")})]})]}),o.jsx(c(),{className:e.mainPaper,variant:"outlined",onScroll:e=>{if(!u||r)return;let{scrollTop:t,scrollHeight:a,clientHeight:o}=e.currentTarget;a-(t+100)<o&&ee()},children:(0,o.jsxs)(p(),{size:"small",children:[o.jsx(S(),{children:(0,o.jsxs)(v(),{children:[o.jsx(f(),{align:"center",children:$.a.t("tags.table.name")}),o.jsx(f(),{align:"center",children:$.a.t("tags.table.tickets")}),o.jsx(f(),{align:"center",children:$.a.t("tags.table.actions")})]})}),o.jsx(x(),{children:(0,o.jsxs)(o.Fragment,{children:[E.map(e=>(0,o.jsxs)(v(),{children:[o.jsx(f(),{align:"center",children:o.jsx(O.Z,{variant:"outlined",style:{backgroundColor:e.color,textShadow:"1px 1px 1px #000",color:"white"},label:e.name,size:"small"})}),o.jsx(f(),{align:"center",children:e.ticketsCount}),(0,o.jsxs)(f(),{align:"center",children:[o.jsx(Z(),{size:"small",onClick:()=>X(e),children:o.jsx(M(),{})}),o.jsx(Z(),{size:"small",onClick:t=>{q(!0),b(e)},children:o.jsx(T(),{})})]})]},e.id)),r&&o.jsx(L.Z,{columns:4})]})})]})})]})};a()}catch(e){a(e)}})},12610:e=>{e.exports=require("@material-ui/core/Button")},8350:e=>{e.exports=require("@material-ui/core/Checkbox")},9069:e=>{e.exports=require("@material-ui/core/CircularProgress")},32705:e=>{e.exports=require("@material-ui/core/Container")},81961:e=>{e.exports=require("@material-ui/core/Dialog")},80929:e=>{e.exports=require("@material-ui/core/DialogActions")},46856:e=>{e.exports=require("@material-ui/core/DialogContent")},82400:e=>{e.exports=require("@material-ui/core/DialogTitle")},83974:e=>{e.exports=require("@material-ui/core/IconButton")},32944:e=>{e.exports=require("@material-ui/core/InputAdornment")},68190:e=>{e.exports=require("@material-ui/core/InputLabel")},48250:e=>{e.exports=require("@material-ui/core/MenuItem")},40640:e=>{e.exports=require("@material-ui/core/Paper")},84614:e=>{e.exports=require("@material-ui/core/Select")},4880:e=>{e.exports=require("@material-ui/core/Table")},31555:e=>{e.exports=require("@material-ui/core/TableBody")},42740:e=>{e.exports=require("@material-ui/core/TableCell")},56956:e=>{e.exports=require("@material-ui/core/TableHead")},11236:e=>{e.exports=require("@material-ui/core/TableRow")},26481:e=>{e.exports=require("@material-ui/core/TextField")},54104:e=>{e.exports=require("@material-ui/core/Typography")},55223:e=>{e.exports=require("@material-ui/core/colors")},48308:e=>{e.exports=require("@material-ui/core/styles")},9371:e=>{e.exports=require("@material-ui/core/utils")},4530:e=>{e.exports=require("@material-ui/icons/DeleteOutline")},93365:e=>{e.exports=require("@material-ui/icons/Edit")},94202:e=>{e.exports=require("@material-ui/icons/Search")},44164:e=>{e.exports=require("@material-ui/lab/Skeleton")},43349:e=>{e.exports=require("@material-ui/styles")},95027:e=>{e.exports=require("@material-ui/system")},23874:e=>{e.exports=require("@material-ui/utils")},52167:e=>{e.exports=require("axios")},68103:e=>{e.exports=require("clsx")},2296:e=>{e.exports=require("formik")},18805:e=>{e.exports=require("i18next")},86071:e=>{e.exports=require("i18next-browser-languagedetector")},98210:e=>{e.exports=require("lodash/has")},35599:e=>{e.exports=require("lodash/isArray")},75795:e=>{e.exports=require("lodash/isObject")},97026:e=>{e.exports=require("lodash/isString")},62684:e=>{e.exports=require("material-ui-color")},32245:e=>{e.exports=require("moment")},62785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},580:e=>{e.exports=require("prop-types")},16689:e=>{e.exports=require("react")},66405:e=>{e.exports=require("react-dom")},14661:e=>{e.exports=require("react-router-dom")},84466:e=>{e.exports=require("react-transition-group")},20997:e=>{e.exports=require("react/jsx-runtime")},75609:e=>{e.exports=require("yup")},3590:e=>{e.exports=import("react-toastify")},14612:e=>{e.exports=import("socket.io-client")},71017:e=>{e.exports=require("path")}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[5388,9908,895,4542,5800,2429],()=>r(67236));module.exports=a})();