"use strict";(()=>{var e={};e.id=1222,e.ids=[1222,660],e.modules={61627:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>g,default:()=>p,getServerSideProps:()=>y,getStaticPaths:()=>x,getStaticProps:()=>h,reportWebVitals:()=>f,routeModule:()=>v,unstable_getServerProps:()=>q,unstable_getServerSideProps:()=>C,unstable_getStaticParams:()=>b,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>S});var s=a(87093),i=a(35244),o=a(1323),n=a(55388),l=a.n(n),c=a(16769),u=a.n(c),d=a(96643),m=e([d]);d=(m.then?(await m)():m)[0];let p=(0,o.l)(d,"default"),h=(0,o.l)(d,"getStaticProps"),x=(0,o.l)(d,"getStaticPaths"),y=(0,o.l)(d,"getServerSideProps"),g=(0,o.l)(d,"config"),f=(0,o.l)(d,"reportWebVitals"),S=(0,o.l)(d,"unstable_getStaticProps"),j=(0,o.l)(d,"unstable_getStaticPaths"),b=(0,o.l)(d,"unstable_getStaticParams"),q=(0,o.l)(d,"unstable_getServerProps"),C=(0,o.l)(d,"unstable_getServerSideProps"),v=new s.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/ContactListItems",pathname:"/ContactListItems",bundlePath:"",filename:""},components:{App:u(),Document:l()},userland:d});r()}catch(e){r(e)}})},20929:(e,t,a)=>{a.d(t,{m:()=>i});let r={user:{static:[]},admin:{static:["dashboard:view","drawer-admin-items:view","tickets-manager:showall","user-modal:editProfile","user-modal:editQueues","ticket-options:deleteTicket","contacts-page:deleteContact","connections-page:actionButtons","connections-page:addConnection","connections-page:editOrDeleteConnection"]}},s=(e,t,a)=>{let s=r[e];if(!s)return!1;let i=s.static;if(i&&i.includes(t))return!0;let o=s.dynamic;if(o){let e=o[t];return!!e&&e(a)}return!1},i=({role:e,perform:t,data:a,yes:r,no:i})=>s(e,t,a)?r():i();i.defaultProps={yes:()=>null,no:()=>null}},82465:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{Z:()=>$});var s=a(20997),i=a(16689),o=a(75609),n=a(2296),l=a(3590),c=a(48308),u=a(55223),d=a(12610),m=a.n(d),p=a(26481),h=a.n(p),x=a(81961),y=a.n(x),g=a(80929),f=a.n(g),S=a(46856),j=a.n(S),b=a(82400),q=a.n(b),C=a(54104),v=a.n(C),I=a(9069),Z=a.n(I),T=a(92921),w=a(38561),P=a(151),k=a(14661),E=a(58582),A=e([l,P,E]);[l,P,E]=A.then?(await A)():A;let L=(0,c.makeStyles)(e=>({root:{display:"flex",flexWrap:"wrap"},textField:{marginRight:e.spacing(1),flex:1},extraAttr:{display:"flex",justifyContent:"center",alignItems:"center"},btnWrapper:{position:"relative"},buttonProgress:{color:u.green[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})),M=o.object().shape({name:o.string().min(2,"Too Short!").max(50,"Too Long!").required("Required"),number:o.string().min(8,"Too Short!").max(50,"Too Long!"),email:o.string().email("Invalid email")}),$=({open:e,onClose:t,contactId:a,initialValues:r,onSave:o})=>{let c=L(),u=(0,i.useRef)(!0),{user:{companyId:d}}=(0,i.useContext)(E.V),{contactListId:p}=(0,k.useParams)(),x={name:"",number:"",email:""},[g,S]=(0,i.useState)(x);(0,i.useEffect)(()=>()=>{u.current=!1},[]),(0,i.useEffect)(()=>{(async()=>{if(r&&S(e=>({...e,...r})),a)try{let{data:e}=await w.Z.get(`/contact-list-items/${a}`);u.current&&S(e)}catch(e){(0,P.Z)(e)}})()},[a,e,r]);let b=()=>{t(),S(x)},C=async e=>{try{if(a)await w.Z.put(`/contact-list-items/${a}`,{...e,companyId:d,contactListId:p}),b();else{let{data:t}=await w.Z.post("/contact-list-items",{...e,companyId:d,contactListId:p});o&&o(t),b()}l.toast.success(T.a.t("contactModal.success"))}catch(e){(0,P.Z)(e)}};return s.jsx("div",{className:c.root,children:(0,s.jsxs)(y(),{open:e,onClose:b,maxWidth:"lg",scroll:"paper",children:[s.jsx(q(),{id:"form-dialog-title",children:a?`${T.a.t("contactModal.title.edit")}`:`${T.a.t("contactModal.title.add")}`}),s.jsx(n.Formik,{initialValues:g,enableReinitialize:!0,validationSchema:M,onSubmit:(e,t)=>{setTimeout(()=>{C(e),t.setSubmitting(!1)},400)},children:({values:e,errors:t,touched:r,isSubmitting:i})=>(0,s.jsxs)(n.Form,{children:[(0,s.jsxs)(j(),{dividers:!0,children:[s.jsx(v(),{variant:"subtitle1",gutterBottom:!0,children:T.a.t("contactModal.form.mainInfo")}),s.jsx(n.Field,{as:h(),label:T.a.t("contactModal.form.name"),name:"name",autoFocus:!0,error:r.name&&!!t.name,helperText:r.name&&t.name,variant:"outlined",margin:"dense",className:c.textField}),s.jsx(n.Field,{as:h(),label:T.a.t("contactModal.form.number"),name:"number",error:r.number&&!!t.number,helperText:r.number&&t.number,placeholder:"5513912344321",variant:"outlined",margin:"dense"}),s.jsx("div",{children:s.jsx(n.Field,{as:h(),label:T.a.t("contactModal.form.email"),name:"email",error:r.email&&!!t.email,helperText:r.email&&t.email,placeholder:"Email address",fullWidth:!0,margin:"dense",variant:"outlined"})})]}),(0,s.jsxs)(f(),{children:[s.jsx(m(),{onClick:b,color:"secondary",disabled:i,variant:"outlined",children:T.a.t("contactModal.buttons.cancel")}),(0,s.jsxs)(m(),{type:"submit",color:"primary",disabled:i,variant:"contained",className:c.btnWrapper,children:[a?`${T.a.t("contactModal.buttons.okEdit")}`:`${T.a.t("contactModal.buttons.okAdd")}`,i&&s.jsx(Z(),{size:24,className:c.buttonProgress})]})]})]})})]})})};r()}catch(e){r(e)}})},58582:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{V:()=>n}),a(20997);var s=a(16689),i=a(85425),o=e([i]);i=(o.then?(await o)():o)[0];let n=(0,s.createContext)();r()}catch(e){r(e)}})},85425:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.d(t,{Z:()=>f});var s=a(16689),i=a(14661),o=a(98210),n=a.n(o),l=a(35599),c=a.n(l),u=a(3590),d=a(92921),m=a(38561),p=a(151),h=a(7405),x=a(32245),y=a.n(x),g=e([u,p,h]);[u,p,h]=g.then?(await g)():g;let f=()=>{let e=(0,i.useNavigate)(),[t,a]=(0,s.useState)(!1),[r,o]=(0,s.useState)(!0),[l,x]=(0,s.useState)({});m.Z.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${JSON.parse(t)}`,a(!0)),e},e=>{Promise.reject(e)}),m.Z.interceptors.response.use(e=>e,async e=>{let t=e.config;if(e?.response?.status===403&&!t._retry){t._retry=!0;let{data:e}=await m.Z.post("/auth/refresh_token");return e&&(localStorage.setItem("token",JSON.stringify(e.token)),m.Z.defaults.headers.Authorization=`Bearer ${e.token}`),(0,m.Z)(t)}return e?.response?.status===401&&(localStorage.removeItem("token"),localStorage.removeItem("companyId"),m.Z.defaults.headers.Authorization=void 0,a(!1)),Promise.reject(e)}),(0,s.useEffect)(()=>{let e=localStorage.getItem("token");(async()=>{if(e)try{let{data:e}=await m.Z.post("/auth/refresh_token");m.Z.defaults.headers.Authorization=`Bearer ${e.token}`,a(!0),x(e.user)}catch(e){(0,p.Z)(e)}o(!1)})()},[]),(0,s.useEffect)(()=>{let e=localStorage.getItem("companyId");if(e){let t=(0,h.C)({companyId:e});return t.on(`company-${e}-user`,e=>{"update"===e.action&&e.user.id===l.id&&x(e.user)}),()=>{t.disconnect()}}},[l]);let g=async t=>{o(!0);try{let{data:l}=await m.Z.post("/auth/login",t),{user:{companyId:h,id:g,company:f}}=l;if(n()(f,"settings")&&c()(f.settings)){let e=f.settings.find(e=>"campaignsEnabled"===e.key);e&&"true"===e.value&&localStorage.setItem("cshow",null)}y().locale("pt-br");let S=l.user.company.dueDate;y()(y()()).format("DD/MM/yyyy");let j=y()(S).format("DD/MM/yyyy");var r=y()(S).diff(y()(y()()).format()),s=y()(y()().format()).isBefore(S),i=y().duration(r).asDays();!0===s?(localStorage.setItem("token",JSON.stringify(l.token)),localStorage.setItem("companyId",h),localStorage.setItem("userId",g),localStorage.setItem("companyDueDate",j),m.Z.defaults.headers.Authorization=`Bearer ${l.token}`,x(l.user),a(!0),u.toast.success(d.a.t("auth.toasts.success")),5>Math.round(i)&&u.toast.warn(`Sua assinatura vence em ${Math.round(i)} ${1===Math.round(i)?"dia":"dias"} `),e.push("/tickets")):(0,p.Z)(`Opss! Sua assinatura venceu ${j}.
Entre em contato com o Suporte para mais informa\xe7\xf5es! `),o(!1)}catch(e){(0,p.Z)(e),o(!1)}},f=async()=>{o(!0);try{await m.Z.delete("/auth/logout"),a(!1),x({}),localStorage.removeItem("token"),localStorage.removeItem("companyId"),localStorage.removeItem("userId"),localStorage.removeItem("cshow"),m.Z.defaults.headers.Authorization=void 0,o(!1),e.push("/login")}catch(e){(0,p.Z)(e),o(!1)}},S=async()=>{try{let{data:e}=await m.Z.get("/auth/me");return e}catch(e){(0,p.Z)(e)}};return{isAuth:t,user:l,loading:r,handleLogin:g,handleLogout:f,getCurrentUserInfo:S}};r()}catch(e){r(e)}})},72094:(e,t,a)=>{a.d(t,{Z:()=>s});var r=a(38561);let s=()=>({findById:async e=>{let{data:t}=await r.Z.request({url:`/contact-lists/${e}`,method:"GET"});return t},save:async e=>{let{data:t}=await r.Z.request({url:"/contact-lists",method:"POST",data:e});return t},update:async e=>{let{data:t}=await r.Z.request({url:`/contact-lists/${e.id}`,method:"PUT",data:e});return t},deleteRecord:async e=>{let{data:t}=await r.Z.request({url:`/contact-lists/${e}`,method:"DELETE"});return t},list:async e=>{let{data:t}=await r.Z.request({url:"/contact-lists/list",method:"GET",params:e});return t}})},96643:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>es});var s=a(20997),i=a(16689),o=a(3590),n=a(14661),l=a(48308),c=a(4880),u=a.n(c),d=a(31555),m=a.n(d),p=a(42740),h=a.n(p),x=a(56956),y=a.n(x),g=a(11236),f=a.n(g),S=a(40640),j=a.n(S),b=a(12610),q=a.n(b),C=a(94202),v=a.n(C),I=a(26481),Z=a.n(I),T=a(32944),w=a.n(T),P=a(83974),k=a.n(P),E=a(4530),A=a.n(E),L=a(93365),M=a.n(L),$=a(33585),D=a.n($),_=a(61457),O=a.n(_),N=a(38561),W=a(29385),B=a(82465),F=a(6133),z=a(92921),R=a(66276),V=a(2926),G=a(96153),H=a(151),J=a(58582),U=a(20929),Q=a(72094),X=a(41749),Y=a(1339),K=a.n(Y),ee=a(7405),et=e([o,B,H,J,ee]);[o,B,H,J,ee]=et.then?(await et)():et;let ea=(e,t)=>{if("LOAD_CONTACTS"===t.type){let a=t.payload,r=[];return a.forEach(t=>{let a=e.findIndex(e=>e.id===t.id);-1!==a?e[a]=t:r.push(t)}),[...e,...r]}if("UPDATE_CONTACTS"===t.type){let a=t.payload,r=e.findIndex(e=>e.id===a.id);return -1!==r?(e[r]=a,[...e]):[a,...e]}if("DELETE_CONTACT"===t.type){let a=t.payload,r=e.findIndex(e=>e.id===a);return -1!==r&&e.splice(r,1),[...e]}if("RESET"===t.type)return[]},er=(0,l.makeStyles)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles}})),es=()=>{let e=er(),{user:t}=(0,i.useContext)(J.V),{contactListId:a}=(0,n.useParams)(),r=(0,n.useNavigate)(),[l,c]=(0,i.useState)(!1),[d,p]=(0,i.useState)(1),[x,g]=(0,i.useState)(""),[S,b]=(0,i.useReducer)(ea,[]),[C,I]=(0,i.useState)(null),[T,P]=(0,i.useState)(!1),[E,L]=(0,i.useState)(null),[$,_]=(0,i.useState)(!1),[Y,et]=(0,i.useState)(!1),[es,ei]=(0,i.useState)({}),eo=(0,i.useRef)(null),{findById:en}=(0,Q.Z)();(0,i.useEffect)(()=>{en(a).then(e=>{ei(e)})},[a]),(0,i.useEffect)(()=>{b({type:"RESET"}),p(1)},[x]),(0,i.useEffect)(()=>{c(!0);let e=setTimeout(()=>{(async()=>{try{let{data:e}=await N.Z.get("contact-list-items",{params:{searchParam:x,pageNumber:d,contactListId:a}});b({type:"LOAD_CONTACTS",payload:e.contacts}),et(e.hasMore),c(!1)}catch(e){(0,H.Z)(e)}})()},500);return()=>clearTimeout(e)},[x,d,a]),(0,i.useEffect)(()=>{let e=localStorage.getItem("companyId"),t=(0,ee.C)({companyId:e});return t.on(`company-${e}-ContactListItem`,e=>{("update"===e.action||"create"===e.action)&&b({type:"UPDATE_CONTACTS",payload:e.record}),"delete"===e.action&&b({type:"DELETE_CONTACT",payload:+e.id}),"reload"===e.action&&b({type:"LOAD_CONTACTS",payload:e.records})}),t.on(`company-${e}-ContactListItem-${a}`,e=>{"reload"===e.action&&b({type:"LOAD_CONTACTS",payload:e.records})}),()=>{t.disconnect()}},[a]);let el=e=>{I(e),P(!0)},ec=async e=>{try{await N.Z.delete(`/contact-list-items/${e}`),o.toast.success(z.a.t("contacts.toasts.deleted"))}catch(e){(0,H.Z)(e)}L(null),g(""),p(1)},eu=async()=>{try{let e=new FormData;e.append("file",eo.current.files[0]),await N.Z.request({url:`contact-lists/${a}/upload`,method:"POST",data:e})}catch(e){(0,H.Z)(e)}},ed=()=>{p(e=>e+1)};return(0,s.jsxs)(G.Z,{className:e.mainContainer,children:[s.jsx(B.Z,{open:T,onClose:()=>{I(null),P(!1)},"aria-labelledby":"form-dialog-title",contactId:C}),s.jsx(F.Z,{title:E?`${z.a.t("contactListItems.confirmationModal.deleteTitle")} ${E.name}?`:`${z.a.t("contactListItems.confirmationModal.importTitlte")}`,open:$,onClose:_,onConfirm:()=>E?ec(E.id):eu(),children:E?`${z.a.t("contactListItems.confirmationModal.deleteMessage")}`:(0,s.jsxs)(s.Fragment,{children:[z.a.t("contactListItems.confirmationModal.importMessage"),s.jsx("a",{href:K(),download:"planilha.xlsx",children:"Clique aqui para baixar planilha exemplo."})]})}),s.jsx(R.Z,{children:(0,s.jsxs)(X.Z,{style:{width:"99.6%"},container:!0,children:[s.jsx(X.Z,{xs:12,sm:5,item:!0,children:s.jsx(V.Z,{children:es.name})}),s.jsx(X.Z,{xs:12,sm:7,item:!0,children:(0,s.jsxs)(X.Z,{spacing:2,container:!0,children:[s.jsx(X.Z,{xs:12,sm:6,item:!0,children:s.jsx(Z(),{fullWidth:!0,placeholder:z.a.t("contactListItems.searchPlaceholder"),type:"search",value:x,onChange:e=>{g(e.target.value.toLowerCase())},InputProps:{startAdornment:s.jsx(w(),{position:"start",children:s.jsx(v(),{style:{color:"gray"}})})}})}),s.jsx(X.Z,{xs:4,sm:2,item:!0,children:s.jsx(q(),{fullWidth:!0,variant:"contained",color:"primary",onClick:()=>{r.push("/contact-lists")},children:z.a.t("contactListItems.buttons.lists")})}),s.jsx(X.Z,{xs:4,sm:2,item:!0,children:s.jsx(q(),{fullWidth:!0,variant:"contained",color:"primary",onClick:()=>{eo.current.value=null,eo.current.click()},children:z.a.t("contactListItems.buttons.import")})}),s.jsx(X.Z,{xs:4,sm:2,item:!0,children:s.jsx(q(),{fullWidth:!0,variant:"contained",color:"primary",onClick:()=>{I(null),P(!0)},children:z.a.t("contactListItems.buttons.add")})})]})})]})}),(0,s.jsxs)(j(),{className:e.mainPaper,variant:"outlined",onScroll:e=>{if(!Y||l)return;let{scrollTop:t,scrollHeight:a,clientHeight:r}=e.currentTarget;a-(t+100)<r&&ed()},children:[s.jsx(s.Fragment,{children:s.jsx("input",{style:{display:"none"},id:"upload",name:"file",type:"file",accept:".xls,.xlsx",onChange:()=>{_(!0)},ref:eo})}),(0,s.jsxs)(u(),{size:"small",children:[s.jsx(y(),{children:(0,s.jsxs)(f(),{children:[s.jsx(h(),{align:"center",style:{width:"0%"},children:"#"}),s.jsx(h(),{children:z.a.t("contactListItems.table.name")}),s.jsx(h(),{align:"center",children:z.a.t("contactListItems.table.number")}),s.jsx(h(),{align:"center",children:z.a.t("contactListItems.table.email")}),s.jsx(h(),{align:"center",children:z.a.t("contactListItems.table.actions")})]})}),s.jsx(m(),{children:(0,s.jsxs)(s.Fragment,{children:[S.map(e=>(0,s.jsxs)(f(),{children:[s.jsx(h(),{align:"center",style:{width:"0%"},children:s.jsx(k(),{children:e.isWhatsappValid?s.jsx(D(),{titleAccess:"Whatsapp V\xe1lido",htmlColor:"green"}):s.jsx(O(),{titleAccess:"Whatsapp Inv\xe1lido",htmlColor:"grey"})})}),s.jsx(h(),{children:e.name}),s.jsx(h(),{align:"center",children:e.number}),s.jsx(h(),{align:"center",children:e.email}),(0,s.jsxs)(h(),{align:"center",children:[s.jsx(k(),{size:"small",onClick:()=>el(e.id),children:s.jsx(M(),{})}),s.jsx(U.m,{role:t.profile,perform:"contacts-page:deleteContact",yes:()=>s.jsx(k(),{size:"small",onClick:()=>{_(!0),L(e)},children:s.jsx(A(),{})})})]})]},e.id)),l&&s.jsx(W.Z,{columns:4})]})})]})]})]})};r()}catch(e){r(e)}})},12610:e=>{e.exports=require("@material-ui/core/Button")},9069:e=>{e.exports=require("@material-ui/core/CircularProgress")},32705:e=>{e.exports=require("@material-ui/core/Container")},81961:e=>{e.exports=require("@material-ui/core/Dialog")},80929:e=>{e.exports=require("@material-ui/core/DialogActions")},46856:e=>{e.exports=require("@material-ui/core/DialogContent")},82400:e=>{e.exports=require("@material-ui/core/DialogTitle")},83974:e=>{e.exports=require("@material-ui/core/IconButton")},32944:e=>{e.exports=require("@material-ui/core/InputAdornment")},40640:e=>{e.exports=require("@material-ui/core/Paper")},4880:e=>{e.exports=require("@material-ui/core/Table")},31555:e=>{e.exports=require("@material-ui/core/TableBody")},42740:e=>{e.exports=require("@material-ui/core/TableCell")},56956:e=>{e.exports=require("@material-ui/core/TableHead")},11236:e=>{e.exports=require("@material-ui/core/TableRow")},26481:e=>{e.exports=require("@material-ui/core/TextField")},54104:e=>{e.exports=require("@material-ui/core/Typography")},55223:e=>{e.exports=require("@material-ui/core/colors")},48308:e=>{e.exports=require("@material-ui/core/styles")},61457:e=>{e.exports=require("@material-ui/icons/Block")},33585:e=>{e.exports=require("@material-ui/icons/CheckCircle")},4530:e=>{e.exports=require("@material-ui/icons/DeleteOutline")},93365:e=>{e.exports=require("@material-ui/icons/Edit")},94202:e=>{e.exports=require("@material-ui/icons/Search")},44164:e=>{e.exports=require("@material-ui/lab/Skeleton")},43349:e=>{e.exports=require("@material-ui/styles")},95027:e=>{e.exports=require("@material-ui/system")},23874:e=>{e.exports=require("@material-ui/utils")},52167:e=>{e.exports=require("axios")},68103:e=>{e.exports=require("clsx")},2296:e=>{e.exports=require("formik")},18805:e=>{e.exports=require("i18next")},86071:e=>{e.exports=require("i18next-browser-languagedetector")},98210:e=>{e.exports=require("lodash/has")},35599:e=>{e.exports=require("lodash/isArray")},75795:e=>{e.exports=require("lodash/isObject")},97026:e=>{e.exports=require("lodash/isString")},32245:e=>{e.exports=require("moment")},62785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},580:e=>{e.exports=require("prop-types")},16689:e=>{e.exports=require("react")},14661:e=>{e.exports=require("react-router-dom")},20997:e=>{e.exports=require("react/jsx-runtime")},75609:e=>{e.exports=require("yup")},3590:e=>{e.exports=import("react-toastify")},14612:e=>{e.exports=import("socket.io-client")},71017:e=>{e.exports=require("path")}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[5388,9908,5800,8810],()=>a(61627));module.exports=r})();